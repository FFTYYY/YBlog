var be=Object.defineProperty,ke=Object.defineProperties;var Ce=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var V=(t,e,r)=>e in t?be(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,d=(t,e)=>{for(var r in e||(e={}))we.call(e,r)&&V(t,r,e[r]);if(te)for(var r of te(e))Se.call(e,r)&&V(t,r,e[r]);return t},u=(t,e)=>ke(t,Ce(e));var l=(t,e,r)=>(V(t,typeof e!="symbol"?e+"":e,r),r);import{N as re,a as h,j as i,b as g,l as F,T as _,S as Ae,E as De,w as Pe,m as Ee,n as Fe,o as Be,P as T,p as Ie,q as Ne,r as Ue,s as Oe,t as ne,f as ie,u as B,I as z,v as Re,x as $e,M as oe,y as M,B as m,z as D,c as G,C as Te,G as ze,H as Me,J as He,K as J,L as Ke,O as We,Q as Le,U as je,V as Ve,W as Ge,X as Je,e as Xe,i as se,k as ae,Y as Ye,Z as qe,_ as Qe,$ as Ze,a0 as A,a1 as et,a2 as tt}from"./vendor.d26df5e7.js";function H(){return Math.floor(Math.random()*23333333)}function X(t=""){return{text:t}}function I(t=""){return{children:[X(t)]}}function rt(t,e,r={}){return{idx:H(),type:"inline",name:t,parameters:e,children:[X("")],hiddens:[],flags:r}}function N(t,e,r={}){return{idx:H(),type:"group",name:t,parameters:e,relation:"separating",children:[I()],hiddens:[],flags:r}}function nt(t,e,r={}){return{idx:H(),type:"struct",name:t,num_children:1,relation:"separating",parameters:e,children:[ce()],hiddens:[],flags:{}}}function it(t,e,r={}){return{idx:H(),type:"support",name:t,parameters:e,children:[X()],hiddens:[],flags:r}}function le(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"}function b(t){return"type"in t}function Ht(t){return"children"in t}function x(t){return b(t)?t.type:"children"in t?"paragraph":"text"}function Kt(t,e,r){return x(t)==e&&t.name==r}function ce(){return N("struct-child",{},{})}function ot(t){return Number(t.slice(0,t.length-3))}function st(t){return`${t}rem`}function Wt(t,e){return st(ot(t)*e)}function at(t,e){for(let r=0;r<t.hiddens.length;r++)if(Y(t.hiddens[r],e))return r;return-1}function de(t,e){let r={};for(let n in t)r[n]=e(t[n]);return r}function lt(t,e,r){return[...t.slice(0,e),r,...t.slice(e+1,t.length)]}function Y(t,e){return!b(t)||!b(e)?!1:t.idx==e.idx}function U(t,e){for(let[r,n]of re.descendants(t))if(Y(r,e))return n}function Lt(t,e){for(let[r,n]of re.descendants(t))if(b(r)&&`${r.idx}`==`${e}`)return n}function q(t,e){if(t==null)return e;if(e==null)return t;if(typeof e=="string"||typeof e=="number"||typeof e=="boolean")return e;if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")return t;let r={};for(let n in d(d({},t),e))r[n]=q(t[n],e[n]);return r}class ue{constructor(e,r=1e3){l(this,"ask_flag");l(this,"trigger_flag");l(this,"task");l(this,"remember_params");this.ask_flag=!1,this.trigger_flag=!0,this.task=e,this.remember_params=void 0;let n=this;setInterval(()=>{n.trigger_flag=!0,n.trigger()},r)}go(e){this.ask_flag=!0,this.remember_params=e,this.trigger()}trigger(){this.ask_flag&&this.trigger_flag&&(this.ask_flag=!1,this.trigger_flag=!1,this.task(this.remember_params))}}class he{constructor(e,r){l(this,"core");l(this,"default_renderers");l(this,"style_renderers");this.core=e,this.default_renderers=r,this.style_renderers={inline:{},group:{},struct:{},support:{}}}get_renderer(e,r=void 0){return r==null?this.default_renderers[e]:this.style_renderers[e][r]||this.default_renderers[e]}update_renderer(e,r,n=void 0){if(n==null){this.default_renderers[r]=e;return}this.style_renderers[r][n]=e}}const fe=h.createContext({});function me(t){return i(fe.Consumer,{children:e=>i(fe.Provider,{value:d(d({},e),t.value),children:t.children})})}class ct extends h.Component{constructor(e){super(e);l(this,"printer");l(this,"core");l(this,"my_refs");l(this,"notification_key");this.state={root:N("root",{})},this.printer=e.printer,this.core=this.printer.core,this.my_refs={}}componentDidMount(){let e=this;this.notification_key=Math.floor(Math.random()*233333);let r=new ue(n=>e.setState({root:n}),1e3);this.core.add_notificatioon(n=>r.go(n),`printer-${this.notification_key}`),this.setState({root:this.core.root})}componentWillUnmount(){this.core.remove_notificatioon(`printer-${this.notification_key}`)}get_path_id(e){return JSON.stringify(e.map(r=>Number(r)))}get_ref(e,r=!1){let n=this.my_refs[this.get_path_id(e)];if(!(!r&&(n==null||n.current==null)))return n}set_ref(e,r){return this.my_refs[this.get_path_id(e)]=r,e}scroll_to(e){let r=this.get_ref(e);r!=null&&r.current.scrollIntoView({behavior:"smooth",block:"center"})}_sub_component(e){let r=e.element,n=this,s=this._sub_component.bind(this),o=this.printer,a=e.contexts,c=e.now_path,f=x(r);if(f=="text"){let S=o.get_renderer("text"),E=i("span",{style:{display:"hidden"},ref:n.get_ref(c,!0)}),xe=r.text;return g(h.Fragment,{children:[E,i(S.render_func,{element:r,context:{anchor:E},children:xe})]})}let v=r.children,k;b(r)&&(k=r.name);let j=o.get_renderer(f,k),$=i("span",{style:{display:"hidden"},ref:n.get_ref(c,!0)});return g(h.Fragment,{children:[$,i(j.render_func,{element:r,context:d({anchor:$},a[this.get_path_id(c)]),children:Object.keys(v).map(S=>i(s,{element:v[S],contexts:a,now_path:[...c,S]},S))})]})}build_envs(e,r,n,s){let o=s;if(this.set_ref(o,h.createRef()),!("children"in e))return[r,n];let a=e,c=x(a),f;b(a)&&(f=a.name);let k=this.printer.get_renderer(c,f),[ee,j]=k.enter_effect(a,r);r=ee;for(let E in a.children)[r,n]=this.build_envs(a.children[E],r,n,[...s,E]);let[$,S]=k.exit_effect(a,r,j);return n[this.get_path_id(o)]=S,[$,n]}render(){let e=this,r=this._sub_component.bind(this);e.my_refs={};let[n,s]=this.build_envs(e.state.root,{},{},[]),o={refs:e.my_refs,root:e.state.root,core:e.core,printer:e.printer,printer_component:e};return i(me,{value:o,children:i(r,{element:e.state.root,contexts:s,now_path:[]})})}}function P(t,e=(n,s)=>[s,{}],r=(n,s,o)=>[s,o]){return{render_func:t,enter_effect:e,exit_effect:r}}class _e extends he{constructor(e){super(e,{text:P(r=>i(F,{children:r.children})),inline:P(r=>i("span",{children:r.children})),paragraph:P(r=>i("span",{children:r.children})),group:P(r=>i("span",{children:r.children})),struct:P(r=>i("span",{children:r.children})),support:P(r=>i("span",{children:r.children}))})}}l(_e,"Component",ct);function dt(t){const e=t.normalizeNode;return t.normalizeNode=r=>{const[n,s]=r;if(x(n)=="struct"){let o=n;if(o.children.length<o.num_children){let a=[];for(let c=0;c<o.num_children-o.children.length;c++)a.push(ce());_.insertNodes(t,a,{at:[...s,o.children.length]});return}if(o.children.length>o.num_children){_.removeNodes(t,{at:[...s,o.children.length-1]});return}for(let a in o.children){let c=o.children[a];if(x(c)!="group"){_.removeNodes(t,{at:[...s,parseInt(a)]});return}}}e(r)},t}function ut(t){const e=t.normalizeNode;let r=n=>x(n)=="group"||x(n)=="struct";return t.normalizeNode=n=>{const[s,o]=n;if(o.length-1,"children"in s&&x(s)!="struct"){let a=!1;for(let[c,f]of s.children.entries()){if(!r(f))continue;if(!a){a=!0;continue}a=!0;let v=f;if(c==0)return;let k=s.children[c-1];if(r(k)&&v.relation=="separating"){_.insertNodes(t,I(),{at:[...o,c]});return}if(!r(k)&&v.relation=="chaining"){_.moveNodes(t,{at:[...o,c-1],to:[...o,c]});return}}}e(n)},t}function ht(t){const e=t.isInline;return t.isInline=r=>{if(b(r)){let n=r;if(n.flags.forceInline)return!0;if(n.flags.forceBlock)return!1}return e(r)||x(r)=="inline"},t}function ft(t){const e=t.isVoid;return t.isVoid=r=>b(r)&&r.flags.forceVoid?!0:e(r)||x(r)=="support",t}var mt=[dt,ut,ht,ft];function _t(t){for(let e of mt)t=e(t);return t}class pt extends h.Component{constructor(e){super(e);l(this,"editor");l(this,"core");l(this,"slate");l(this,"onUpdate");l(this,"onKeyDown");l(this,"onKeyUp");l(this,"onKeyPress");l(this,"onFocusChange");this.state={clipboard:void 0},this.editor=e.editor,this.core=this.editor.core,this.slate=this.editor.slate,this.onUpdate=e.onUpdate||(r=>{}),this.onKeyDown=e.onKeyDown||(r=>{}),this.onKeyUp=e.onKeyUp||(r=>{}),this.onKeyPress=e.onKeyPress||(r=>{}),this.onFocusChange=e.onFocusChange||(()=>{})}update_value(e){this.core.update_children(e),this.onUpdate(e)}renderElement(e){let r=this,n=e.element,s=x(n),o;b(n)&&(o=n.name);let a=this.editor.get_renderer(s,o),c=e.attributes,f={element:n,editor:r.editor,children:e.children},v={};return r.editor.slate.isInline(n)&&(v={display:"inline-block"}),i("div",u(d({},c),{style:v,children:i(a,d({},f))}))}renderLeaf(e){let r=this,n=this.editor.get_renderer("text"),s=e.attributes,o={element:e.leaf,editor:r.editor,children:e.children};return i("span",u(d({},s),{children:i(n,d({},o))}))}render(){let e=this;e.editor.slate;let r={editor:e.editor,slate:e.slate,core:e.core};return i(me,{value:r,children:i(Ae,{editor:e.slate,value:[I("")],onChange:n=>{e.update_value(n),e.onFocusChange()},children:i(De,{renderElement:e.renderElement.bind(e),renderLeaf:e.renderLeaf.bind(e),onClick:n=>{e.onFocusChange()},onCopy:async n=>!0,onKeyDown:n=>e.onKeyDown(n),onKeyUp:n=>e.onKeyUp(n),onKeyPress:n=>{e.onKeyPress(n)}})})})}}class Q extends he{constructor(e){super(e,{text:r=>i("span",{children:r.children}),inline:r=>i("span",{children:r.children}),paragraph:r=>i("div",{children:r.children}),group:r=>i("div",{children:r.children}),struct:r=>i("div",{children:r.children}),support:r=>i("div",{children:r.children})});l(this,"suboperations");l(this,"slate");this.slate=_t(Pe(Ee(Be()))),this.suboperations={}}add_suboperation(e,r){this.suboperations[e]=r}apply_all(){let e=this;Object.values(this.suboperations).map(r=>{r(e)}),this.suboperations={}}get_onClick(e,r){let n=this;if(n.core.root,e=="group"||e=="support"||e=="struct"){let s=n.core.get_style(e,r);return s==null?()=>{}:()=>{let o=s.makenode();_.insertNodes(n.slate,o)}}if(e=="inline"){let s=n.core.get_style("inline",r);return s==null?()=>{}:()=>{let o=n.slate.selection,a=!0;o!=null&&(a=JSON.stringify(o.anchor)==JSON.stringify(o.focus));let c=s.makenode();a?_.insertNodes(n.slate,c):_.wrapNodes(n.slate,c,{match:f=>Fe.isText(f),split:!0})}}return()=>{}}}l(Q,"Component",pt);class gt{constructor(e,r){l(this,"styles");l(this,"root");l(this,"notifications");this.styles={inline:{},group:{},struct:{},support:{},abstract:{}};for(let n of e)this.add_style(n);this.root=N("root",r),this.notifications={}}update_children(e){return this.update_root({children:e})}update_root(e){this.root=d(d({},this.root),e);for(let r of Object.values(this.notifications))r(this.root)}add_notificatioon(e,r){this.notifications[r]=e}remove_notificatioon(e){delete this.notifications[e]}add_style(e){this.styles[e.type][e.name]=e}get_style(e,r){return this.styles[e][r]}}class jt{constructor(e,r,n={}){l(this,"type","inline");l(this,"name");l(this,"parameter_prototype");l(this,"flags");l(this,"makenode");this.name=e,this.parameter_prototype=r,this.flags=n,this.makenode=()=>rt(e,r,n)}}class Vt{constructor(e,r,n={}){l(this,"type","group");l(this,"name");l(this,"parameter_prototype");l(this,"flags");l(this,"makenode");this.name=e,this.parameter_prototype=r,this.flags=n,this.makenode=()=>N(e,r,n)}}class Gt{constructor(e,r,n={}){l(this,"type","struct");l(this,"name");l(this,"parameter_prototype");l(this,"flags");l(this,"makenode");this.name=e,this.parameter_prototype=r,this.flags=n,this.makenode=()=>nt(e,r,n)}}class Jt{constructor(e,r,n={}){l(this,"type","support");l(this,"name");l(this,"parameter_prototype");l(this,"flags");l(this,"makenode");this.name=e,this.parameter_prototype=r,this.flags=n,this.makenode=()=>it(e,r,n)}}class Xt{constructor(e,r){l(this,"type","abstract");l(this,"name");l(this,"parameter_prototype");l(this,"flags");l(this,"makehidden");this.name=e,this.parameter_prototype=r,this.flags={},this.makehidden=()=>N(e,r)}}function O(t,e,r){let n=t.core.root;if(Y(e,n)){t.core.update_root(r);return}_.setNodes(t.slate,r,{at:U(t.slate,e)})}function yt(t,e){_.removeNodes(t.slate,{at:U(t.core.root,e)})}function Yt(t,e){_.removeNodes(t.slate,{at:e})}function qt(t,e,r){_.insertNodes(t.slate,e,{at:r})}function vt(t,e,r){_.insertNodes(t.slate,e,{at:U(t.core.root,r)})}function xt(t,e,r){let n=U(t.core.root,r);n[n.length-1]++,_.insertNodes(t.slate,e,{at:n})}function bt(t,e,r){let n=t.core.root,s=U(n,e);n.idx==e.idx&&(s=[]);let o=e.children.length;o>0&&_.removeNodes(t.slate,{at:{anchor:{path:[...s,0],offset:0},focus:{path:[...s,o-1],offset:0}}}),_.insertNodes(t.slate,r,{at:[...s,0]})}const C=h.createContext("row"),pe=h.createContext(!1);function R(t){let e=t.title||"";return i(C.Consumer,{children:r=>i(Ue,{title:e,placement:r=="row"?"left":"top",children:t.children})})}function kt(t){let e=!t.simple,r=n=>{let s=n=="row"?"horizontal":"vertical",o=e?n=="row"?"column":"row":n;return i(C.Provider,{value:o,children:i(Oe,u(d({orientation:s},t.buttongroup_props),{children:t.children}))})};return t.force_direction!=null?r(t.force_direction):i(C.Consumer,{children:n=>r(n)})}function ge(t){let e=!t.simple,r=n=>{let s=e?n=="row"?"column":"row":n;return i(C.Provider,{value:s,children:i(ne,{direction:n,children:t.children})})};return t.force_direction!=null?r(t.force_direction):i(C.Consumer,{children:n=>r(n)})}function Qt(t){let e=r=>i(C.Provider,{value:r,children:i(ne,{direction:r,children:t.children})});return t.force_direction!=null?e(t.force_direction):i(C.Consumer,{children:r=>e(r)})}class Ct extends h.Component{constructor(e){super(e)}render(){let e=this.props,r=e.stacker||ge,n=e.component||T,s=o=>i(pe.Consumer,{children:a=>i(Ie,{anchorEl:e.anchorEl,open:e.open,placement:o=="row"?"right":"bottom",disablePortal:a,transition:!0,children:({TransitionProps:c})=>i(Ne,u(d({},c),{timeout:350,children:i(n,{children:i(r,{children:e.children})})}))})});return e.force_direction!=null?s(e.force_direction):i(C.Consumer,{children:o=>s(o)})}}const ye={palette:{divider:"#00000077",primary:{main:"#111111"}},editor:{margins:{background:"0.5rem",paragraph:"0.8rem",small:"0.2rem"},widths:{editable_drawer:"70%",minimum_content:"3rem"},typography:{body:{fontFamily:"default",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400},structure:{fontFamily:"Century Gothic, SimHei",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400}}},printer:{margins:{paragraph:"0.4rem",special:"0.8rem",colon:"1rem",level:"2rem",structure:"0.4rem"},typography:{body:{fontFamily:"default",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400},weaken:{fontFamily:"default",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400},structure:{fontFamily:"default",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400},display:{fontFamily:"default",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400},title:{fontFamily:"default",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400}}}};function wt(t){let e=t.element,r=t.editor,n=r.core.styles.abstract,s=t.onClose||(a=>{});function o(a){return c=>{if(s(c),a==null||n[a]==null)return;let f=[...e.hiddens,n[a].makehidden()];O(r,e,{hiddens:f})}}return i(oe,{anchorEl:t.anchor_element,open:t.open,onClose:s,children:Object.keys(n).map(a=>i(M,{onClick:o(a),children:a},a))})}class St extends h.Component{constructor(e){super(e);l(this,"subeditor");l(this,"hiddenid");l(this,"father_editor");l(this,"father");l(this,"son");this.state={drawer_open:!1},this.subeditor=new Q(new gt([...Object.values(e.editor.core.styles.inline),...Object.values(e.editor.core.styles.group),...Object.values(e.editor.core.styles.struct),...Object.values(e.editor.core.styles.support),...Object.values(e.editor.core.styles.abstract)],e.editor.core.root.parameters)),this.subeditor.default_renderers=e.editor.default_renderers,this.subeditor.style_renderers=e.editor.style_renderers,this.father_editor=e.editor,this.father=e.father,this.son=e.son}sub_apply(e){let r=this.father,n=this.son,s=at(r,n),o=u(d({},n),{children:this.subeditor.core.root.children}),a=lt(r.hiddens,s,o);O(e,r,{hiddens:a})}render(){let e=this;return this.props,i(ie,{anchor:"left",open:e.props.open,onClose:e.props.onClose,ModalProps:{keepMounted:!0},PaperProps:{sx:{width:"60%"}},SlideProps:{onExited:()=>{e.father_editor.apply_all()}},children:i(pe.Provider,{value:!0,children:i($t,{editor:e.subeditor,onMount:()=>{bt(e.subeditor,e.subeditor.core.root,e.props.son.children),e.props.editor.add_suboperation(`${e.son.idx}-hidden`,e.sub_apply.bind(e))}})})})}}function At(t){let e=t.element,r=t.editor,n=e.hiddens,s=t.onClose||(c=>{}),[o,a]=B.exports.useState(void 0);return g(F,{children:[i(oe,{anchorEl:t.anchor_element,open:t.open,onClose:t.onClose,children:Object.keys(n).map(c=>g(M,{onClick:f=>{a(c),s(f)},children:[n[c].name,"-",c]},c))}),Object.keys(n).map(c=>i(St,{editor:r,father:e,son:e.hiddens[c],open:o==c,onClose:f=>{a(void 0)}},c))]})}function Dt(t){let e=t.editor,r=t.element,[n,s]=B.exports.useState(void 0),[o,a]=B.exports.useState(void 0);return g(F,{children:[i(R,{title:"\u65B0\u5EFA\u62BD\u8C61",children:i(z,{onClick:c=>s(c.currentTarget),children:i(Re,{})})}),i(R,{title:"\u7F16\u8F91\u62BD\u8C61",children:i(z,{onClick:c=>a(c.currentTarget),children:i($e,{})})}),i(wt,{editor:e,element:r,anchor_element:n,open:n!=null,onClose:c=>s(void 0)}),i(At,{editor:e,element:r,anchor_element:o,open:o!=null,onClose:c=>{a(void 0)}})]})}const Zt=t=>i(m,u(d({contentEditable:!1},t),{sx:[{userSelect:"none"},...Array.isArray(t.sx)?t.sx:[t.sx]]})),er=t=>i(D,u(d({component:m},t),{sx:[e=>u(d({},e.editor.typography.body),{marginTop:e.editor.margins.paragraph}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),Pt=t=>i(D,u(d({component:m},t),{sx:[e=>u(d({},e.editor.typography.structure),{marginY:"auto",height:e.editor.typography.structure.lineHeight,whiteSpace:"nowrap"}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),Et=t=>i(m,u(d({},t),{autogrow:void 0,sx:[d({paddingX:e=>e.editor.margins.background},t.autogrow?{flex:1,minWidth:0}:{}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),tr=t=>i(T,u(d({elevation:0,variant:"outlined",square:!0},t),{is_inline:void 0,sx:[d({},t.is_inline?{display:"inline-block",minHeight:e=>e.editor.typography.body.lineHeight,color:e=>e.palette.secondary.dark,marginX:e=>e.editor.margins.small}:{marginTop:e=>e.editor.margins.paragraph,color:e=>e.palette.primary.main}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),rr=t=>i(m,u(d({},t),{sx:[{marginTop:e=>e.editor.margins.paragraph},...Array.isArray(t.sx)?t.sx:[t.sx]]})),Ft=t=>i(T,u(d({elevation:0,variant:"outlined",square:!0},t),{sx:[{width:"100%",height:"100%",overflow:"hidden"},...Array.isArray(t.sx)?t.sx:[t.sx]]}));class Bt extends h.Component{constructor(e){super(e);l(this,"parameters");l(this,"onUpdate");this.parameters=this.props.initval,this.onUpdate=e.onUpdate||(r=>{})}componentDidUpdate(){this.parameters=this.props.initval,this.onUpdate=this.props.onUpdate||(e=>{})}get_all_treenodes(e,r){let n=this,s=[];for(let o in r){let a=[...e,o];le(r[o])||(s.push(a),s=[...s,...n.get_all_treenodes(a,r[o])])}return s}renderValue(e){let r=e.name,n=e.val,s=e.onChange,o={defaultValue:n,label:r,variant:"standard",sx:{marginLeft:"5%"}};return typeof n=="string"?i(G,d({onChange:a=>s(a.target.value)},o)):typeof n=="number"?i(G,d({onChange:a=>s(a.target.value),type:"number"},o)):typeof n=="boolean"?g(G,u(d({onChange:a=>{s(a.target.value=="true")}},o),{children:[i(M,{value:"true",children:"true"},0),i(M,{value:"false",children:"false"},1)]})):i(F,{})}renderDict(e){let r=d({},e.val),n=this.renderValue.bind(this),s=this.renderDict.bind(this),o=[...e.father_names,e.name],a=JSON.stringify(o);return i(Te,{nodeId:a,label:e.name,sx:{width:"auto",overflowX:"hidden"},children:Object.keys(e.val).map(c=>{let f=e.val[c];return le(f)?i(n,{name:c,val:f,onChange:v=>{r[c]=v,e.onChange(r)}},c):i(s,{name:c,val:f,father_names:o,onChange:v=>{r[c]=v,e.onChange(r)}},c)})})}render(){let e=this.renderDict.bind(this),r=this,n="Parameters",s=Object.values(this.get_all_treenodes([],{[n]:r.parameters})).map(o=>JSON.stringify(o));return i(ze,{defaultExpanded:s,disableSelection:!0,disabledItemsFocusable:!0,defaultCollapseIcon:i(Me,{}),defaultExpandIcon:i(He,{}),children:i(e,{name:n,val:r.parameters,father_names:[],onChange:o=>{r.parameters=o,r.onUpdate(o)}})})}}class It extends h.Component{constructor(e){super(e)}temp_update_value(e){let r=this.props;r.editor.add_suboperation(`${r.element.idx}-parameter`,n=>{O(n,r.element,{parameters:e})})}componentDidUpdate(e,r,n){}render(){let e=this,r=this.props;return i(Bt,{initval:r.element.parameters,onUpdate:n=>e.temp_update_value(n)})}}function Nt(t){let e=t.onClose||(r=>{});return g(ie,{anchor:"left",open:t.open,onClose:e,ModalProps:{keepMounted:!0},SlideProps:{onExited:()=>{t.editor.apply_all()}},PaperProps:{sx:{width:"40%"}},children:[i(m,{children:g(Pt,{children:["idx: ",t.element.idx]})}),i(J,{}),i(It,{editor:t.editor,element:t.element})]})}function K(t){let e=t.icon,r=t.component||"button";return i(R,{title:t.title,children:i(z,{onClick:t.onClick,size:t.size,component:r,children:i(e,{})})})}function Ut(t){let[e,r]=B.exports.useState(!1),n=t.onClose||(s=>{});return g(F,{children:[i(K,{onClick:s=>r(!0),title:"\u8BBE\u7F6E\u53C2\u6570",icon:Ke}),i(Nt,{editor:t.editor,element:t.element,open:e,onClose:s=>{n(s),r(!1)}})]})}function nr(t){return i(K,{onClick:e=>{yt(t.editor,t.element)},title:"\u5220\u9664\u7EC4\u4EF6",icon:Le})}function ir(t){return g(h.Fragment,{children:[i(K,{onClick:e=>{vt(t.editor,I(),t.element)},title:"\u5411\u4E0A\u6DFB\u52A0\u6BB5\u843D",icon:je}),i(K,{onClick:e=>{xt(t.editor,I(),t.element)},title:"\u5411\u4E0B\u6DFB\u52A0\u6BB5\u843D",icon:Ve})]})}function Ot(t){let e=t.button_class,[r,n]=h.useState(!1),s=h.useRef(),o=t.onClose||(()=>{}),a=f=>{n(f),f||o()},c=g(h.Fragment,{children:[i(R,{title:t.title,children:i(e,d({onClick:f=>a(!r),ref:s},t.button_props))}),i(Ct,u(d({anchorEl:s.current,open:r},t.poper_props),{children:t.children}))]});return t.close_on_otherclick?i(We,{onClickAway:()=>{a(!1)},children:i(m,{children:c})}):c}function or(t){let e=t.element,r=t.editor,[n,s]=B.exports.useState(e.relation=="chaining");function o(a){let c=a.target.checked;s(c),c==!1&&O(r,e,{relation:"separating"}),c==!0&&O(r,e,{relation:"chaining"})}return i(R,{title:"\u8D34\u8D34",children:i(Ge,{checked:n,onChange:o})})}class Rt extends h.Component{constructor(e){super(e);l(this,"editor");l(this,"button_refs");this.state={cur_type_idx:0,cur_styl_idx:0},this.editor=e.editor;let r=this.editor.core;this.button_refs={group:Object.keys(r.styles.group).map(n=>h.createRef()),inline:Object.keys(r.styles.inline).map(n=>h.createRef()),support:Object.keys(r.styles.support).map(n=>h.createRef()),struct:Object.keys(r.styles.struct).map(n=>h.createRef())}}get_ref(e,r){if(e==null||r==null)return;let n=["group","inline","support","struct"],s=this.button_refs[n[e]][r];if(s&&s.current)return s.current}update_selection(e){let r=this.get_ref(e.cur_type_idx,e.cur_styl_idx),n=this.get_ref(this.state.cur_type_idx,this.state.cur_styl_idx);r&&(r.style.border="none"),n&&(n.style.border="2px solid #112233")}normalize_idx(e,r){const n=["group","inline","support","struct"],s=n.length;e=(e%s+s)%s;let o=Object.keys(this.editor.core.styles[n[e]]).length;return r=(r%o+o)%o,[e,r]}move({x:e=0,y:r=0}){let[n,s]=this.normalize_idx(this.state.cur_type_idx+r,this.state.cur_styl_idx+e);this.setState({cur_type_idx:n,cur_styl_idx:s})}force_click(){let r=["group","inline","support","struct"][this.state.cur_type_idx],n=Object.keys(this.editor.core.styles[r])[this.state.cur_styl_idx];this.editor.get_onClick(r,n)()}componentDidMount(){this.update_selection({cur_type_idx:void 0,cur_styl_idx:void 0})}componentDidUpdate(e,r,n){this.update_selection(r)}render(){let e={group:Ye,inline:qe,support:Qe,struct:Ze},r=this;return i(h.Fragment,{children:["group","inline","support","struct"].map(n=>{let s=e[n];return i(h.Fragment,{children:i(Ot,{poper_props:{stacker:kt,component:Je(T)({backgroundColor:"#aabbddbb"})},button_class:z,button_props:{children:i(s,{})},title:n,children:Object.keys(r.editor.core.styles[n]).map((o,a)=>g(h.Fragment,{children:[i(Xe,{onClick:c=>r.editor.get_onClick(n,o)(),variant:"text",ref:r.button_refs[n][a],children:o}),i(J,{orientation:"vertical",flexItem:!0})]},a))})},n)})})}}class $t extends h.Component{constructor(e){super(e);l(this,"editor");l(this,"onUpdate");l(this,"onMount");l(this,"onFocusChange");l(this,"notification_key");l(this,"buttonbar_ref");this.state={ctrl_key:{}},this.editor=e.editor,this.onUpdate=e.onUpdate||(r=>{}),this.onMount=e.onMount||(()=>{}),this.onFocusChange=e.onFocusChange||(()=>{}),this.buttonbar_ref=h.createRef()}componentDidMount(){let e=this;this.onMount(),this.notification_key=Math.floor(Math.random()*233333);let r=new ue(()=>{e.forceUpdate()},1e3);this.editor.core.add_notificatioon(()=>r.go(),`editor-${this.notification_key}`)}componentWillUnmount(){this.editor.core.remove_notificatioon(`editor-${this.notification_key}`)}is_selecting(){return this.state.ctrl_key.q}flush_key_state(e,r){r.ctrlKey?e?this.state.ctrl_key[r.key]||this.setState({ctrl_key:u(d({},this.state.ctrl_key),{[r.key]:!0})}):this.state.ctrl_key[r.key]&&this.setState({ctrl_key:u(d({},this.state.ctrl_key),{[r.key]:void 0})}):Object.keys(this.state.ctrl_key).length>0&&this.setState({ctrl_key:{}})}prevent_key_down(e){if(!this.is_selecting())return!1;if(this.buttonbar_ref&&this.buttonbar_ref.current&&(this.buttonbar_ref.current,e.key=="ArrowLeft"||e.key=="ArrowRight"||e.key=="ArrowDown"||e.key=="ArrowUp"||e.key=="Enter"))return e.preventDefault(),!0}handle_key_press(e){if(!this.is_selecting())return!1;if(this.buttonbar_ref&&this.buttonbar_ref.current){let r=this.buttonbar_ref.current;if(e.key=="ArrowLeft")return r.move({x:-1}),e.preventDefault(),!0;if(e.key=="ArrowRight")return r.move({x:1}),e.preventDefault(),!0;if(e.key=="ArrowDown")return r.move({y:1}),e.preventDefault(),!0;if(e.key=="ArrowUp")return r.move({y:-1}),e.preventDefault(),!0;if(e.key=="Enter")return r.force_click(),e.preventDefault(),!0}return!1}render(){let e={xs:.15,md:.1,xl:.05},r=de(e,a=>1-a),n=a=>de(a,c=>`${Math.floor(c*100)%100}%`),s=q(ye,this.props.theme),o=this;return i(se,{theme:ae(s),children:g(Ft,{children:[i(m,{sx:{position:"absolute",height:"100%",width:r,overflow:"auto"},children:i(Et,{children:i(Q.Component,{editor:o.editor,onUpdate:o.onUpdate,onFocusChange:o.onFocusChange,onKeyDown:a=>(this.flush_key_state(!0,a),this.prevent_key_down(a)),onKeyUp:a=>(this.flush_key_state(!1,a),this.handle_key_press(a))})})}),i(m,{sx:{position:"absolute",height:"100%",left:n(r),width:e},children:g(ge,{force_direction:"column",children:[i(Ut,{editor:o.editor,element:o.editor.core.root}),i(Dt,{editor:o.editor,element:o.editor.core.root}),o.props.extra_buttons,i(J,{}),i(Rt,{editor:o.editor,selecting:o.is_selecting(),ref:o.buttonbar_ref})]})})]})})}}const sr=t=>i(D,u(d({component:t.inline?"span":m},t),{inline:void 0,sx:[e=>d(d({},e.printer.typography.weaken),t.inline?{marginRight:r=>r.printer.margins.colon,display:"inline-block"}:{}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),ar=t=>i(D,u(d({component:t.inline?"span":m},t),{inline:void 0,sx:[e=>d(d({},e.printer.typography.display),t.inline?{marginRight:r=>r.printer.margins.colon,display:"inline-block"}:{}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),lr=t=>i(D,u(d({component:m},t),{sx:[e=>({fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit",lineSpacing:"inherit",fontWeight:"inherit",marginTop:e.printer.margins.paragraph}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),cr=t=>i(D,u(d({component:t.inline?"span":m},t),{inline:void 0,leftmargin:void 0,sx:[e=>d(d({},e.printer.typography.structure),t.inline?u(d({},t.leftmargin?{marginLeft:r=>r.printer.margins.colon}:{marginRight:r=>r.printer.margins.colon}),{display:"inline-block"}):{}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),dr=t=>i(m,u(d({},t),{subtitle_like:void 0,small_margin:void 0,sx:[e=>u(d({},t.subtitle_like?e.printer.typography.title:{}),{marginTop:t.small_margin?e.printer.margins.paragraph:e.printer.margins.special}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),ur=t=>i(m,u(d({},t),{sx:[{marginLeft:e=>e.printer.margins.level},...Array.isArray(t.sx)?t.sx:[t.sx]]})),hr=t=>i(m,u(d({},t),{sx:[{width:e=>e.printer.margins.level},...Array.isArray(t.sx)?t.sx:[t.sx]]})),Tt=t=>i(m,u(d({},t),{sx:[e=>u(d({},e.printer.typography.body),{padding:e.printer.margins.structure,boxSizing:"border-box",height:"100%",width:"100%",overflowY:"auto",wordWrap:"break-word"}),...Array.isArray(t.sx)?t.sx:[t.sx]]}));class fr extends h.Component{constructor(e){super(e);l(this,"printer");l(this,"main");this.printer=e.printer,this.main=h.createRef()}scroll_to(e){this.main.current!=null&&this.main.current.scroll_to(e)}render(){let e=q(ye,this.props.theme),r=this.main;return i(se,{theme:ae(e),children:i(Tt,{children:i(_e.Component,{ref:r,printer:this.printer})})})}}function Z(t){let e=et(`#_data_${t}`);if(!!e)return e.html()}var W={csrf:Z("csrf"),node_id:parseInt(Z("node_id")),logged_in:Z("logged_in").toLocaleLowerCase()=="true"},ve="/";function p(t){return t.startsWith("/")&&(t=t.slice(1,t.length)),`${ve}${t}`}A.defaults.baseURL=ve;A.defaults.xsrfHeaderName="X-CSRFToken";A.defaults.headers.post["X-CSRFToken"]=W.csrf;async function w(t,e,r){r==null&&(r=W.node_id);let n=(await A.get(t(r))).data;return e!=null&&(n=n[e]),n}async function L(t,e,r,n){return r==null&&(r=W.node_id),(await A.post(t(r),e,n)).data.status}var y={get:{content:t=>p(`get/node/content/${t}`),nodetree:t=>p(`get/nodetree/${t}`),concept:t=>p(`get/node/concepts/${t}`),create_time:t=>p(`get/node/create_time/${t}`),comments:t=>p(`get/node/comments/${t}`),resources:t=>p(`get/node/resources/${t}`),resource_info:t=>p(`get/node/resource_info/${t}`),son_ids:t=>p(`get/node/son_ids/${t}`),father_id:t=>p(`get/node/father_id/${t}`)},post:{content:t=>p(`post/node/content/${t}`),comments:t=>p(`post/node/comments/${t}`),nodetree:t=>p(`post/nodetree/${t}`),file:t=>p(`post/file/${t}`),manage_recourse:t=>p(`post/manage_recourse/${t}`)},view:{content:t=>p(`view/content/${t}`)}},mr={get:{content:t=>w(y.get.content,"content",t),nodetree:t=>w(y.get.nodetree,"data",t),concept:t=>w(y.get.concept,"concepts",t),create_time:t=>w(y.get.create_time,void 0,t),comments:t=>w(y.get.comments,"comments",t),resources:t=>w(y.get.resources,"resources",t),resource_info:async(t,e)=>(e==null&&(e=W.node_id),(await A.get(y.get.resource_info(e),{params:{name:t}})).data),son_ids:t=>w(y.get.son_ids,"son_ids",t),father_id:t=>w(y.get.father_id,"father_id",t)},post:{content:(t,e)=>L(y.post.content,t,e),nodetree:(t,e)=>L(y.post.nodetree,t,e),comments:(t,e)=>L(y.post.comments,t,e),file:(t,e)=>L(y.post.file,t,e,{headers:{"Content-Type":"multipart/form-data"}}),manage_recourse:async(t,e,r)=>{let n=t?{headers:{"Content-Type":"multipart/form-data"}}:{};return(await A.post(y.post.manage_recourse(r),e,n)).data.status}}};function _r(t){return i(tt,{anchorOrigin:{vertical:"top",horizontal:"center"},open:t.open,message:t.status?t.info_sucess:t.info_fail,onClose:()=>t.onClose()})}export{ge as A,Wt as B,lr as C,$t as D,gt as E,cr as F,ur as G,sr as H,mr as I,ar as J,hr as K,P as L,p as M,ir as N,fe as O,_r as P,Lt as Q,Vt as R,Qt as S,Gt as T,Xt as U,jt as V,Jt as W,W as X,Q as Y,y as Z,b as a,K as b,R as c,Yt as d,qt as e,_e as f,fr as g,Ht as h,Kt as i,Zt as j,Pt as k,Ut as l,Dt as m,or as n,nr as o,I as p,Et as q,Ot as r,O as s,tr as t,rr as u,C as v,vt as w,xt as x,er as y,dr as z};
