var D=Object.defineProperty,R=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var w=(n,e,r)=>e in n?D(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,p=(n,e)=>{for(var r in e||(e={}))N.call(e,r)&&w(n,r,e[r]);if(v)for(var r of v(e))j.call(e,r)&&w(n,r,e[r]);return n},g=(n,e)=>R(n,I(e));var f=(n,e,r)=>(w(n,typeof e!="symbol"?e+"":e,r),r);import"./modulepreload-polyfill.9d8db203.js";import{a as s,j as t,m as x,B as a,b as l,a4 as L,a5 as P,v as C,a6 as S,I as M,a3 as F,p as u,q as B,L as W,a7 as U,a8 as X,a9 as A,aa as E,N as Y,c as q,d as O,R as $}from"./vendor.7620ad78.js";import{I as m,R as G,A as T,o as H,T as J,i as b,E as K,P as Q,x as V,a as Z}from"./buttons.956eb144.js";import{n as ee,w as te,b as re,m as ne,c as k}from"./theme.eebd064b.js";import{N as oe}from"./nodetree.bff3fd0f.js";class y extends s.Component{constructor(e){super(e);this.state={title:void 0}}async componentDidMount(){let e=await m.get.content(this.props.node_id);this.setState({title:e.parameters.title})}render(){return t(x,{children:this.state.title})}}class ie extends s.Component{constructor(e){super(e);this.state={nodetree:void 0,now_node_id:void 0}}async componentDidMount(){let e=await m.get.nodetree(0);this.setState({nodetree:new oe(e),now_node_id:G()})}render(){if(this.state.now_node_id==null)return t(x,{});let e=this,r=this.state.nodetree.id2node(this.state.now_node_id),o=i=>{let c=i.icon;return t(a,{sx:{marginTop:"0.5rem"},children:l(T,{children:[c?t(H,{title:i.title,children:t(M,{size:"small",sx:{height:"0.9rem",marginY:"auto"},onClick:i.onClick,children:t(c,{sx:{fontSize:"0.9rem"}})})}):t(x,{}),t(F,{sx:d=>({fontSize:"0.9rem"}),underline:"hover",href:i.url,children:i.words})]})})};return t(a,{sx:{marginTop:"0.5rem"},children:l(T,{force_direction:"column",children:[r.father_id>=0?t(o,{words:t(y,{node_id:r.my_id}),title:"\u4E0A\u884C",onClick:()=>e.setState({now_node_id:r.father_id}),icon:L,url:"#"}):t(o,{words:t(y,{node_id:r.my_id}),url:"#"}),r.sons.map((i,c)=>t(a,{sx:{marginLeft:d=>d.printer.margins.level},children:i.sons.length>0?t(o,{words:t(y,{node_id:i.my_id}),title:"\u4E0B\u884C",onClick:()=>e.setState({now_node_id:i.my_id}),icon:P,url:"#"}):t(o,{words:t(y,{node_id:i.my_id}),url:"#"})},c))]})})}}class ae extends s.Component{constructor(e){super(e);this.state={create_time:void 0,modify_time:void 0}}async componentDidMount(){let e=await m.get.create_time();this.setState({create_time:e.create_time,modify_time:e.modify_time})}render(){let e=this,r=this.props.core.root.parameters.title,o=i=>l(a,{sx:c=>({marginBottom:"1rem"}),children:[t(u,{color:"text.secondary",sx:{marginRight:c=>c.printer.margins.colon,fontSize:"0.5rem",display:"inline-block"},children:i.title}),t(u,{sx:{fontSize:"0.8rem",display:"inline-block"},children:i.content})]});return l(s.Fragment,{children:[t(o,{title:"\u9898\u76EE",content:`${r}`}),t(o,{title:"\u521B\u5EFA\u65F6\u95F4",content:e.state.create_time}),t(o,{title:"\u4FEE\u6539\u65F6\u95F4",content:e.state.modify_time})]})}}class se extends s.Component{constructor(e){super(e)}render(){return l(a,{sx:e=>p({},e.printer.typography.body),children:[t(ae,{core:this.props.core}),t(C,{sx:{fontSize:"0.8rem"},children:t(S,{sx:{fontSize:"0.8rem"},label:"\u5BFC\u822A"})}),t(ie,{})]})}}class le extends s.Component{constructor(e){super(e);this.state={comments:[]}}async update(){let e=await m.get.comments();e=e.reverse(),this.setState({comments:e})}async componentDidMount(){await this.update()}render(){let e=this,r=o=>l(a,{sx:{marginBottom:"1rem",marginX:"0.5rem"},children:[t(u,{sx:{marginLeft:"0.5rem",fontSize:"0.9rem"},children:o.content}),l(u,{sx:{textAlign:"right",marginTop:"0.5rem",fontSize:"0.9rem"},children:["\u2014\u2014",o.name]})]});return t(s.Fragment,{children:e.state.comments.map((o,i)=>{let[c,d]=o;return t(r,{name:d,content:c},i)})})}}class ce extends s.Component{constructor(e){super(e);this.state={content:"",name:"",snakerbar_open:!1,status:!1}}async submit(){let e=this,r=!1;e.state.content&&(r=await m.post.comments({content:e.state.content,name:e.state.name})),e.setState({status:r,snakerbar_open:!0}),r&&(e.props.onRenew(),e.setState({content:"",name:""}))}render(){let e=this;return l(s.Fragment,{children:[t(B,{label:"\u7559\u8A00",placeholder:"\u8BF4\u70B9\u5565",multiline:!0,onChange:r=>{e.setState({content:r.target.value})},variant:"outlined",fullWidth:!0,minRows:4,sx:{marginTop:"2rem"},value:e.state.content}),t(B,{label:"\u79F0\u547C",placeholder:"\u4F60\u662F\u8C01\uFF1F",onChange:r=>{e.setState({name:r.target.value})},variant:"standard",fullWidth:!0,sx:{marginTop:"0.5rem"},value:e.state.name}),t(a,{sx:{textAlign:"right",marginTop:"1rem"},children:t(W,{variant:"outlined",onClick:()=>e.submit(),children:"\u65B0\u5EFA\u7559\u8A00"})}),t(J,{info_sucess:"\u63D0\u4EA4\u6210\u529F",info_fail:"\u63D0\u4EA4\u5931\u8D25",open:e.state.snakerbar_open,status:e.state.status,onClose:()=>e.setState({snakerbar_open:!1})})]})}}class de extends s.Component{constructor(e){super(e);f(this,"comment_ref");this.comment_ref=s.createRef()}render(){let e=this;return l(a,{sx:r=>g(p({},r.printer.typography.structure),{overflowY:"auto",position:"absolute",top:"5%",bottom:"2%",left:"0",right:"0",paddingX:"1rem"}),children:[t(ce,{onRenew:()=>{e.comment_ref&&e.comment_ref.current&&e.comment_ref.current.update()}}),t(C,{sx:{marginTop:"3rem"},children:t(S,{sx:{fontSize:"0.8rem"},label:"\u7559\u8A00\u5217\u8868"})}),t(le,{ref:e.comment_ref})]})}}function me(n){const[e,r]=s.useState("1");return t(U,{value:e,children:l(a,{sx:{height:"100%"},children:[l(X,{onChange:(o,i)=>r(i),variant:"scrollable",scrollButtons:"auto",children:[t(A,{label:"\u57FA\u672C",value:"1"}),t(A,{label:"\u7559\u8A00",value:"2"})]}),t(E,{value:"1",children:t(se,{core:n.core})}),t(E,{value:"2",children:t(de,{})})]})})}function ue(n){let e=[];for(let[r,o]of Y.descendants(n))(b(r,"support","\u5C0F\u8282\u7EBF")||b(r,"support","\u7AE0\u8282\u7EBF"))&&e.push([r,o]);return e}function he(n){let e=n.core.root,r=ue(e);return console.log(r),l(a,{sx:o=>g(p({},o.printer.typography.body),{position:"relative",top:"30%"}),children:[t(u,{color:"text.secondary",sx:o=>g(p({},o.printer.typography.body),{fontSize:"0.9rem"}),children:"\u7AE0\u5185\u76EE\u5F55"}),r.map((o,i)=>{let[c,d]=o,_=t(x,{children:"\u7AE0\u8282"});return b(c,"support","\u5C0F\u8282\u7EBF")&&(_=l(s.Fragment,{children:[t(a,{component:"span",sx:{marginRight:"1rem"},children:ee(Number(i)+1)}),t(a,{component:"span",children:c.parameters.title})]})),t(a,{sx:{marginTop:"0.2rem"},children:t(F,{component:"button",underline:"hover",onClick:h=>{n.onScroll(d)},children:t(u,{sx:{fontSize:"0.8rem"},children:_})})},i)})]})}class pe extends s.Component{constructor(e){super(e);f(this,"core");f(this,"printer");f(this,"printer_ref");this.core=te(new K([],{title:""})),this.printer=re(new Q(this.core)),this.printer_ref=s.createRef()}async componentDidMount(){var e=await m.get.content();this.core.update_root(e);var r=await m.get.concept();for(let[o,i,c,d,_]of r){let[h,fe,z]=ne(i,o,c,d,_);this.core.add_style(h),h.type!="abstract"&&this.printer.update_renderer(z,h.type,h.name)}this.forceUpdate()}render(){let e=this;return l(q,{theme:O(k),children:[t(a,{sx:{position:"absolute",top:"2%",left:"1%",height:"96%",width:"17%"},children:t(me,{core:e.printer.core})}),l(a,{sx:{position:"absolute",top:"2%",left:"20%",height:"96%",width:"60%",display:"flex"},children:[t(a,{sx:{position:"absolute",width:"98%",left:"1%",top:"1%",height:"3%"},children:t(V,{sx:{textAlign:"center"},children:e.printer.core.root.parameters.title})}),t(a,{sx:{position:"absolute",width:"98%",left:"1%",top:"5%",height:"94%"},children:t(Z,{printer:e.printer,theme:k,ref:e.printer_ref})})]}),t(a,{sx:{position:"absolute",top:"2%",left:"81%",height:"96%",width:"17%"},children:t(he,{core:e.printer.core,onScroll:r=>{e.printer_ref&&e.printer_ref.current&&e.printer_ref.current.scroll_to(r)}})})]})}}$.render(t(s.StrictMode,{children:t(pe,{})}),document.getElementById("root"));
