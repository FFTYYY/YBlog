var be=Object.defineProperty,Ce=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var L=(t,e,n)=>e in t?be(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,c=(t,e)=>{for(var n in e||(e={}))Se.call(e,n)&&L(t,n,e[n]);if(ee)for(var n of ee(e))we.call(e,n)&&L(t,n,e[n]);return t},h=(t,e)=>Ce(t,ke(e));var d=(t,e,n)=>(L(t,typeof e!="symbol"?e+"":e,n),n);import{N as te,a as m,j as i,b as _,T as g,S as Fe,E as Ae,w as Pe,e as Be,f as De,g as Ie,P as z,h as Ee,F as Ne,i as Te,k as ne,l as ze,D as re,r as S,m as O,I as F,A as Oe,n as Re,M as ie,o as R,B as p,p as A,q as V,s as Ue,t as He,u as Me,C as We,v as G,x as $e,y as Le,z as Ve,G as Ge,H as Je,J as Xe,c as oe,d as ae,K as Ye,L as U,O as je,Q as qe,U as Qe,V as Ke,W as B,$ as se,X as Ze,Y as et,Z as tt,_ as le}from"./vendor.7620ad78.js";function H(){return Math.floor(Math.random()*23333333)}function J(t=""){return{text:t}}function D(t=""){return{children:[J(t)]}}function nt(t,e,n={}){return{idx:H(),type:"inline",name:t,parameters:e,children:[J("")],hiddens:[],flags:n}}function I(t,e,n={}){return{idx:H(),type:"group",name:t,parameters:e,relation:"separating",children:[D()],hiddens:[],flags:n}}function rt(t,e,n={}){return{idx:H(),type:"struct",name:t,num_children:1,relation:"separating",parameters:e,children:[ce()],hiddens:[],flags:{}}}function it(t,e,n={}){return{idx:H(),type:"support",name:t,parameters:e,children:[J()],hiddens:[],flags:n}}function de(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"}function v(t){return"type"in t}function y(t){return v(t)?t.type:"children"in t?"paragraph":"text"}function Lt(t,e,n){return y(t)==e&&t.name==n}function ce(){return I("struct-child",{},{})}function ot(t){return Number(t.slice(0,t.length-3))}function at(t){return`${t}rem`}function Vt(t,e){return at(ot(t)*e)}function st(t,e){for(let n=0;n<t.hiddens.length;n++)if(X(t.hiddens[n],e))return n;return-1}function ue(t,e){let n={};for(let r in t)n[r]=e(t[r]);return n}function lt(t,e,n){return[...t.slice(0,e),n,...t.slice(e+1,t.length)]}function X(t,e){return!v(t)||!v(e)?!1:t.idx==e.idx}function E(t,e){for(let[n,r]of te.descendants(t))if(X(n,e))return r}function Gt(t,e){for(let[n,r]of te.descendants(t))if(v(n)&&`${n.idx}`==`${e}`)return r}function Y(t,e){if(t==null)return e;if(e==null)return t;if(typeof e=="string"||typeof e=="number"||typeof e=="boolean")return e;if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")return t;let n={};for(let r in c(c({},t),e))n[r]=Y(t[r],e[r]);return n}class he{constructor(e,n){d(this,"core");d(this,"default_renderers");d(this,"style_renderers");this.core=e,this.default_renderers=n,this.style_renderers={inline:{},group:{},struct:{},support:{}}}get_renderer(e,n=void 0){return n==null?this.default_renderers[e]:this.style_renderers[e][n]||this.default_renderers[e]}update_renderer(e,n,r=void 0){if(r==null){this.default_renderers[n]=e;return}this.style_renderers[n][r]=e}}const me=m.createContext({});function fe(t){return i(me.Consumer,{children:e=>i(me.Provider,{value:c(c({},e),t.value),children:t.children})})}class dt extends m.Component{constructor(e){super(e);d(this,"printer");d(this,"core");d(this,"my_refs");this.state={root:I("root",{})},this.printer=e.printer,this.core=this.printer.core,this.my_refs={}}componentDidMount(){let e=this;this.core.add_notificatioon(n=>e.setState({root:n})),this.setState({root:this.core.root})}get_path_id(e){return JSON.stringify(e.map(n=>Number(n)))}get_ref(e,n=!1){let r=this.my_refs[this.get_path_id(e)];if(!(!n&&(r==null||r.current==null)))return r}set_ref(e,n){return this.my_refs[this.get_path_id(e)]=n,e}scroll_to(e){let n=this.get_ref(e);n!=null&&n.current.scrollIntoView({behavior:"smooth",block:"center"})}_sub_component(e){let n=e.element,r=this,o=this._sub_component.bind(this),a=this.printer,s=e.contexts,l=e.now_path,u=y(n);if(u=="text"){let k=a.get_renderer("text"),$=n.text;return _(m.Fragment,{children:[i("span",{style:{display:"hidden"},ref:r.get_ref(l,!0)}),i(k.render_func,{element:n,context:{},children:$})]})}let f=n.children,x;v(n)&&(x=n.name);let W=a.get_renderer(u,x);return _(m.Fragment,{children:[i("span",{style:{display:"hidden"},ref:r.get_ref(l,!0)}),i(W.render_func,{element:n,context:s[this.get_path_id(l)],children:Object.keys(f).map(k=>i(o,{element:f[k],contexts:s,now_path:[...l,k]},k))})]})}build_envs(e,n,r,o){let a=o;if(this.set_ref(a,m.createRef()),!("children"in e))return[n,r];let s=e,l=y(s),u;v(s)&&(u=s.name);let x=this.printer.get_renderer(l,u),[K,W]=x.enter_effect(s,n);n=K;for(let Z in s.children)[n,r]=this.build_envs(s.children[Z],n,r,[...o,Z]);let[k,$]=x.exit_effect(s,n,W);return r[this.get_path_id(a)]=$,[k,r]}render(){let e=this,n=this._sub_component.bind(this);e.my_refs={};let[r,o]=this.build_envs(e.state.root,{},{},[]),a={refs:e.my_refs,root:e.state.root,core:e.core,printer:e.printer,printer_component:e};return i(fe,{value:a,children:i(n,{element:e.state.root,contexts:o,now_path:[]})})}}function P(t,e=(r,o)=>[o,{}],n=(r,o,a)=>[o,a]){return{render_func:t,enter_effect:e,exit_effect:n}}class pe extends he{constructor(e){super(e,{text:P(n=>i("span",{children:n.children})),inline:P(n=>i("span",{children:n.children})),paragraph:P(n=>i("span",{children:n.children})),group:P(n=>i("span",{children:n.children})),struct:P(n=>i("span",{children:n.children})),support:P(n=>i("span",{children:n.children}))})}}d(pe,"Component",dt);function ct(t){const e=t.normalizeNode;return t.normalizeNode=n=>{const[r,o]=n;if(y(r)=="struct"){let a=r;if(a.children.length<a.num_children){let s=[];for(let l=0;l<a.num_children-a.children.length;l++)s.push(ce());g.insertNodes(t,s,{at:[...o,a.children.length]});return}if(a.children.length>a.num_children){g.removeNodes(t,{at:[...o,a.children.length-1]});return}for(let s in a.children){let l=a.children[s];if(y(l)!="group"){g.removeNodes(t,{at:[...o,parseInt(s)]});return}}}e(n)},t}function ut(t){const e=t.normalizeNode;let n=r=>y(r)=="group"||y(r)=="struct";return t.normalizeNode=r=>{const[o,a]=r;if(a.length-1,"children"in o&&y(o)!="struct"){let s=!1;for(let[l,u]of o.children.entries()){if(!n(u))continue;if(!s){s=!0;continue}s=!0;let f=u;if(l==0)return;let x=o.children[l-1];if(n(x)&&f.relation=="separating"){g.insertNodes(t,D(),{at:[...a,l]});return}if(!n(x)&&f.relation=="chaining"){g.moveNodes(t,{at:[...a,l-1],to:[...a,l]});return}}}e(r)},t}function ht(t){const e=t.isInline;return t.isInline=n=>{if(v(n)){let r=n;if(r.flags.forceInline)return!0;if(r.flags.forceBlock)return!1}return e(n)||y(n)=="inline"},t}function mt(t){const e=t.isVoid;return t.isVoid=n=>v(n)&&n.flags.forceVoid?!0:e(n)||y(n)=="support",t}var ft=[ct,ut,ht,mt];function pt(t){for(let e of ft)t=e(t);return t}class _t extends m.Component{constructor(e){super(e);d(this,"editor");d(this,"core");d(this,"slate");d(this,"onUpdate");d(this,"onFocusChange");this.editor=e.editor,this.core=this.editor.core,this.slate=this.editor.slate,this.onUpdate=e.onUpdate||(n=>{}),this.onFocusChange=e.onFocusChange||(()=>{})}update_value(e){this.core.update_children(e),this.onUpdate(e)}renderElement(e){let n=this,r=e.element,o=y(r),a;v(r)&&(a=r.name);let s=this.editor.get_renderer(o,a),l=e.attributes,u={element:r,editor:n.editor,children:e.children},f={};return n.editor.slate.isInline(r)&&(f={display:"inline-block"}),i("div",h(c({},l),{style:f,children:i(s,c({},u))}))}renderLeaf(e){let n=this,r=this.editor.get_renderer("text"),o=e.attributes,a={element:e.leaf,editor:n.editor,children:e.children};return i("span",h(c({},o),{children:i(r,c({},a))}))}render(){let e=this,n={editor:e.editor,slate:e.slate,core:e.core};return i(fe,{value:n,children:i(Fe,{editor:e.slate,value:[D("")],onChange:r=>{e.update_value(r),e.onFocusChange()},children:i(Ae,{renderElement:e.renderElement.bind(e),renderLeaf:e.renderLeaf.bind(e),onClick:r=>{e.onFocusChange()}})})})}}class j extends he{constructor(e){super(e,{text:n=>i("span",{children:n.children}),inline:n=>i("span",{children:n.children}),paragraph:n=>i("div",{children:n.children}),group:n=>i("div",{children:n.children}),struct:n=>i("div",{children:n.children}),support:n=>i("div",{children:n.children})});d(this,"suboperations");d(this,"slate");this.slate=pt(Pe(Be(Ie()))),this.suboperations={}}add_suboperation(e,n){this.suboperations[e]=n}apply_all(){let e=this;Object.values(this.suboperations).map(n=>{n(e)}),this.suboperations={}}get_onClick(e,n){let r=this;if(r.core.root,e=="group"||e=="support"||e=="struct"){let o=r.core.get_style(e,n);return o==null?a=>{}:a=>{let s=o.makenode();g.insertNodes(r.slate,s)}}if(e=="inline"){let o=r.core.get_style("inline",n);return o==null?a=>{}:a=>{let s=r.slate.selection,l=!0;s!=null&&(l=JSON.stringify(s.anchor)==JSON.stringify(s.focus));let u=o.makenode();l?g.insertNodes(r.slate,u):g.wrapNodes(r.slate,u,{match:f=>De.isText(f),split:!0})}}return o=>{}}}d(j,"Component",_t);class gt{constructor(e,n){d(this,"styles");d(this,"root");d(this,"notifications");this.styles={inline:{},group:{},struct:{},support:{},abstract:{}};for(let r of e)this.add_style(r);this.root=I("root",n),this.notifications=[]}update_children(e){return this.update_root({children:e})}update_root(e){this.root=c(c({},this.root),e);for(let n of this.notifications)n(this.root)}add_notificatioon(e){this.notifications.push(e)}add_style(e){this.styles[e.type][e.name]=e}get_style(e,n){return this.styles[e][n]}}class Jt{constructor(e,n,r={}){d(this,"type","inline");d(this,"name");d(this,"parameter_prototype");d(this,"flags");d(this,"makenode");this.name=e,this.parameter_prototype=n,this.flags=r,this.makenode=()=>nt(e,n,r)}}class Xt{constructor(e,n,r={}){d(this,"type","group");d(this,"name");d(this,"parameter_prototype");d(this,"flags");d(this,"makenode");this.name=e,this.parameter_prototype=n,this.flags=r,this.makenode=()=>I(e,n,r)}}class Yt{constructor(e,n,r={}){d(this,"type","struct");d(this,"name");d(this,"parameter_prototype");d(this,"flags");d(this,"makenode");this.name=e,this.parameter_prototype=n,this.flags=r,this.makenode=()=>rt(e,n,r)}}class jt{constructor(e,n,r={}){d(this,"type","support");d(this,"name");d(this,"parameter_prototype");d(this,"flags");d(this,"makenode");this.name=e,this.parameter_prototype=n,this.flags=r,this.makenode=()=>it(e,n,r)}}class qt{constructor(e,n){d(this,"type","abstract");d(this,"name");d(this,"parameter_prototype");d(this,"flags");d(this,"makehidden");this.name=e,this.parameter_prototype=n,this.flags={},this.makehidden=()=>I(e,n)}}function N(t,e,n){let r=t.core.root;if(X(e,r)){t.core.update_root(n);return}g.setNodes(t.slate,n,{at:E(t.slate,e)})}function yt(t,e){g.removeNodes(t.slate,{at:E(t.core.root,e)})}function xt(t,e,n){g.insertNodes(t.slate,e,{at:E(t.core.root,n)})}function vt(t,e,n){let r=E(t.core.root,n);r[r.length-1]++,g.insertNodes(t.slate,e,{at:r})}function bt(t,e,n){let r=t.core.root,o=E(r,e);r.idx==e.idx&&(o=[]);let a=e.children.length;a>0&&g.removeNodes(t.slate,{at:{anchor:{path:[...o,0],offset:0},focus:{path:[...o,a-1],offset:0}}}),g.insertNodes(t.slate,n,{at:[...o,0]})}const b=m.createContext("row"),_e=m.createContext(!1);function w(t){let e=t.title||"";return i(b.Consumer,{children:n=>i(ze,{title:e,placement:n=="row"?"left":"top",children:t.children})})}function Ct(t){let e=!t.simple,n=r=>{let o=r=="row"?"horizontal":"vertical",a=e?r=="row"?"column":"row":r;return i(b.Provider,{value:a,children:i(Te,h(c({orientation:o},t.buttongroup_props),{children:t.children}))})};return t.force_direction!=null?n(t.force_direction):i(b.Consumer,{children:r=>n(r)})}function q(t){let e=!t.simple,n=r=>{let o=e?r=="row"?"column":"row":r;return i(b.Provider,{value:o,children:i(ne,{direction:r,children:t.children})})};return t.force_direction!=null?n(t.force_direction):i(b.Consumer,{children:r=>n(r)})}function Qt(t){let e=n=>i(b.Provider,{value:n,children:i(ne,{direction:n,children:t.children})});return t.force_direction!=null?e(t.force_direction):i(b.Consumer,{children:n=>e(n)})}class kt extends m.Component{constructor(e){super(e)}render(){let e=this.props,n=e.stacker||q,r=e.component||z,o=a=>i(_e.Consumer,{children:s=>i(Ee,{anchorEl:e.anchorEl,open:e.open,placement:a=="row"?"right":"bottom",disablePortal:s,transition:!0,children:({TransitionProps:l})=>i(Ne,h(c({},l),{timeout:350,children:i(r,{children:i(n,{children:e.children})})}))})});return e.force_direction!=null?o(e.force_direction):i(b.Consumer,{children:a=>o(a)})}}const ge={palette:{divider:"#00000077",primary:{main:"#111111"}},editor:{margins:{background:"0.5rem",paragraph:"0.8rem",small:"0.2rem"},widths:{editable_drawer:"70%",minimum_content:"3rem"},typography:{body:{fontFamily:"default",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400},structure:{fontFamily:"Century Gothic, SimHei",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400}}},printer:{margins:{paragraph:"0.4rem",special:"0.8rem",colon:"1rem",level:"2rem",structure:"0.4rem"},typography:{body:{fontFamily:"default",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400},weaken:{fontFamily:"default",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400},structure:{fontFamily:"default",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400},display:{fontFamily:"default",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400},title:{fontFamily:"default",fontSize:"1rem",lineHeight:"1.5rem",lineSpacing:"0.00938em",fontWeight:400}}}};function St(t){let e=t.element,n=t.editor,r=n.core.styles.abstract,o=t.onClose||(s=>{});function a(s){return l=>{if(o(l),s==null||r[s]==null)return;let u=[...e.hiddens,r[s].makehidden()];N(n,e,{hiddens:u})}}return i(ie,{anchorEl:t.anchor_element,open:t.open,onClose:o,children:Object.keys(r).map(s=>i(R,{onClick:a(s),children:s},s))})}class wt extends m.Component{constructor(e){super(e);d(this,"subeditor");d(this,"hiddenid");d(this,"father_editor");d(this,"father");d(this,"son");this.state={drawer_open:!1},this.subeditor=new j(new gt([...Object.values(e.editor.core.styles.inline),...Object.values(e.editor.core.styles.group),...Object.values(e.editor.core.styles.struct),...Object.values(e.editor.core.styles.support),...Object.values(e.editor.core.styles.abstract)],e.editor.core.root.parameters)),this.subeditor.default_renderers=e.editor.default_renderers,this.subeditor.style_renderers=e.editor.style_renderers,this.father_editor=e.editor,this.father=e.father,this.son=e.son}sub_apply(e){let n=this.father,r=this.son,o=st(n,r),a=h(c({},r),{children:this.subeditor.core.root.children}),s=lt(n.hiddens,o,a);N(e,n,{hiddens:s})}render(){let e=this;return this.props,i(re,{anchor:"left",open:e.props.open,onClose:e.props.onClose,ModalProps:{keepMounted:!0},PaperProps:{sx:{width:"60%"}},SlideProps:{onExited:()=>{e.father_editor.apply_all()}},children:i(_e.Provider,{value:!0,children:i(Ot,{editor:e.subeditor,onMount:()=>{bt(e.subeditor,e.subeditor.core.root,e.props.son.children),e.props.editor.add_suboperation(`${e.son.idx}-hidden`,e.sub_apply.bind(e))}})})})}}function Ft(t){let e=t.element,n=t.editor,r=e.hiddens,o=t.onClose||(l=>{}),[a,s]=S.exports.useState(void 0);return _(O,{children:[i(ie,{anchorEl:t.anchor_element,open:t.open,onClose:t.onClose,children:Object.keys(r).map(l=>_(R,{onClick:u=>{s(l),o(u)},children:[r[l].name,"-",l]},l))}),Object.keys(r).map(l=>i(wt,{editor:n,father:e,son:e.hiddens[l],open:a==l,onClose:u=>{s(void 0)}},l))]})}function At(t){let e=t.editor,n=t.element,[r,o]=S.exports.useState(void 0),[a,s]=S.exports.useState(void 0);return _(O,{children:[i(w,{title:"\u65B0\u5EFA\u62BD\u8C61",children:i(F,{onClick:l=>o(l.currentTarget),children:i(Oe,{})})}),i(w,{title:"\u7F16\u8F91\u62BD\u8C61",children:i(F,{onClick:l=>s(l.currentTarget),children:i(Re,{})})}),i(St,{editor:e,element:n,anchor_element:r,open:r!=null,onClose:l=>o(void 0)}),i(Ft,{editor:e,element:n,anchor_element:a,open:a!=null,onClose:l=>{s(void 0)}})]})}const Kt=t=>i(p,h(c({contentEditable:!1},t),{sx:[{userSelect:"none"},...Array.isArray(t.sx)?t.sx:[t.sx]]})),Zt=t=>i(A,h(c({component:p},t),{sx:[e=>h(c({},e.editor.typography.body),{marginTop:e.editor.margins.paragraph}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),Pt=t=>i(A,h(c({component:p},t),{sx:[e=>h(c({},e.editor.typography.structure),{marginY:"auto",height:e.editor.typography.structure.lineHeight,whiteSpace:"nowrap"}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),Bt=t=>i(p,h(c({},t),{autogrow:void 0,sx:[c({paddingX:e=>e.editor.margins.background},t.autogrow?{flex:1,minWidth:0}:{}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),en=t=>i(z,h(c({elevation:0,variant:"outlined",square:!0},t),{is_inline:void 0,sx:[c({},t.is_inline?{display:"inline-block",height:e=>e.editor.typography.body.lineHeight,color:e=>e.palette.secondary.dark,marginX:e=>e.editor.margins.small}:{marginTop:e=>e.editor.margins.paragraph,color:e=>e.palette.primary.main}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),tn=t=>i(p,h(c({},t),{sx:[{marginTop:e=>e.editor.margins.paragraph},...Array.isArray(t.sx)?t.sx:[t.sx]]})),Dt=t=>i(z,h(c({elevation:0,variant:"outlined",square:!0},t),{sx:[{width:"100%",height:"100%",overflow:"hidden"},...Array.isArray(t.sx)?t.sx:[t.sx]]}));class It extends m.Component{constructor(e){super(e);d(this,"parameters");d(this,"onUpdate");this.parameters=this.props.initval,this.onUpdate=e.onUpdate||(n=>{})}componentDidUpdate(){this.parameters=this.props.initval,this.onUpdate=this.props.onUpdate||(e=>{})}get_all_treenodes(e,n){let r=this,o=[];for(let a in n){let s=[...e,a];de(n[a])||(o.push(s),o=[...o,...r.get_all_treenodes(s,n[a])])}return o}renderValue(e){let n=e.name,r=e.val,o=e.onChange,a={defaultValue:r,label:n,variant:"standard",sx:{marginLeft:"5%"}};return typeof r=="string"?i(V,c({onChange:s=>o(s.target.value)},a)):typeof r=="number"?i(V,c({onChange:s=>o(s.target.value),type:"number"},a)):typeof r=="boolean"?_(V,h(c({onChange:s=>{o(s.target.value=="true")},select:!0},a),{children:[i(R,{value:"true",children:"true"},0),i(R,{value:"false",children:"false"},1)]})):i(O,{})}renderDict(e){let n=c({},e.val),r=this.renderValue.bind(this),o=this.renderDict.bind(this),a=[...e.father_names,e.name],s=JSON.stringify(a);return i(Ue,{nodeId:s,label:e.name,sx:{width:"auto",overflowX:"hidden"},children:Object.keys(e.val).map(l=>{let u=e.val[l];return de(u)?i(r,{name:l,val:u,onChange:f=>{n[l]=f,e.onChange(n)}},l):i(o,{name:l,val:u,father_names:a,onChange:f=>{n[l]=f,e.onChange(n)}},l)})})}render(){let e=this.renderDict.bind(this),n=this,r="Parameters",o=Object.values(this.get_all_treenodes([],{[r]:n.parameters})).map(a=>JSON.stringify(a));return i(He,{defaultExpanded:o,disableSelection:!0,disabledItemsFocusable:!0,defaultCollapseIcon:i(Me,{}),defaultExpandIcon:i(We,{}),children:i(e,{name:r,val:n.parameters,father_names:[],onChange:a=>{n.parameters=a,n.onUpdate(a)}})})}}class Et extends m.Component{constructor(e){super(e)}temp_update_value(e){let n=this.props;n.editor.add_suboperation(`${n.element.idx}-parameter`,r=>{N(r,n.element,{parameters:e})})}componentDidUpdate(e,n,r){}render(){let e=this,n=this.props;return i(It,{initval:n.element.parameters,onUpdate:r=>e.temp_update_value(r)})}}function Nt(t){let e=t.onClose||(n=>{});return _(re,{anchor:"left",open:t.open,onClose:e,ModalProps:{keepMounted:!0},SlideProps:{onExited:()=>{t.editor.apply_all()}},PaperProps:{sx:{width:"40%"}},children:[i(p,{children:_(Pt,{children:["idx: ",t.element.idx]})}),i(G,{}),i(Et,{editor:t.editor,element:t.element})]})}function M(t){let e=t.icon;return i(w,{title:t.title,children:i(F,{onClick:t.onClick,size:t.size,children:i(e,{})})})}function Tt(t){let[e,n]=S.exports.useState(!1),r=t.onClose||(o=>{});return _(O,{children:[i(M,{onClick:o=>n(!0),title:"\u8BBE\u7F6E\u53C2\u6570",icon:$e}),i(Nt,{editor:t.editor,element:t.element,open:e,onClose:o=>{r(o),n(!1)}})]})}function nn(t){return i(M,{onClick:e=>{yt(t.editor,t.element)},title:"\u5220\u9664\u7EC4\u4EF6",icon:Ve})}function rn(t){return _(m.Fragment,{children:[i(M,{onClick:e=>{xt(t.editor,D(),t.element)},title:"\u5411\u4E0A\u6DFB\u52A0\u6BB5\u843D",icon:Ge}),i(M,{onClick:e=>{vt(t.editor,D(),t.element)},title:"\u5411\u4E0B\u6DFB\u52A0\u6BB5\u843D",icon:Je})]})}function zt(t){let e=t.button_class,[n,r]=m.useState(!1),o=m.useRef(),a=t.onClose||(()=>{}),s=u=>{r(u),u||a()},l=_(m.Fragment,{children:[i(w,{title:t.title,children:i(e,c({onClick:u=>s(!n),ref:o},t.button_props))}),i(kt,h(c({anchorEl:o.current,open:n},t.poper_props),{children:t.children}))]});return t.close_on_otherclick?i(Le,{onClickAway:()=>{s(!1)},children:i(p,{children:l})}):l}function on(t){let e=t.element,n=t.editor,[r,o]=S.exports.useState(e.relation=="chaining");function a(s){let l=s.target.checked;o(l),l==!1&&N(n,e,{relation:"separating"}),l==!0&&N(n,e,{relation:"chaining"})}return i(w,{title:"\u8D34\u5408",children:i(Xe,{checked:r,onChange:a})})}class Ot extends m.Component{constructor(e){super(e);d(this,"editor");d(this,"onUpdate");d(this,"onMount");d(this,"onFocusChange");this.editor=e.editor,this.onUpdate=e.onUpdate||(n=>{}),this.onMount=e.onMount||(()=>{}),this.onFocusChange=e.onFocusChange||(()=>{})}componentDidMount(){let e=this;this.onMount(),this.editor.core.add_notificatioon(()=>{e.forceUpdate()})}render(){let e={group:je,inline:qe,support:Qe,struct:Ke},n={xs:.15,md:.1,xl:.05},r=ue(n,l=>1-l),o=l=>ue(l,u=>`${Math.floor(u*100)%100}%`),a=Y(ge,this.props.theme),s=this;return i(oe,{theme:ae(a),children:_(Dt,{children:[i(p,{sx:{position:"absolute",height:"100%",width:r,overflow:"auto"},children:i(Bt,{children:i(j.Component,{editor:s.editor,onUpdate:s.onUpdate,onFocusChange:s.onFocusChange})})}),i(p,{sx:{position:"absolute",height:"100%",left:o(r),width:n},children:_(q,{force_direction:"column",children:[i(Tt,{editor:s.editor,element:s.editor.core.root}),i(At,{editor:s.editor,element:s.editor.core.root}),i(G,{}),["group","inline","support","struct"].map(l=>{let u=e[l];return i(m.Fragment,{children:i(zt,{poper_props:{stacker:Ct,component:Ye(z)({backgroundColor:"#aabbddbb"})},button_class:F,button_props:{children:i(u,{})},title:l,children:Object.keys(s.editor.core.styles[l]).map(f=>_(m.Fragment,{children:[i(U,{onClick:x=>s.editor.get_onClick(l,f)(x),variant:"text",children:f}),i(G,{orientation:"vertical",flexItem:!0})]},f))})},l)})]})})]})})}}const an=t=>i(A,h(c({component:t.inline?"span":p},t),{inline:void 0,sx:[e=>c(c({},e.printer.typography.weaken),t.inline?{marginRight:n=>n.printer.margins.colon,display:"inline-block"}:{}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),sn=t=>i(A,h(c({component:t.inline?"span":p},t),{inline:void 0,sx:[e=>c(c({},e.printer.typography.display),t.inline?{marginRight:n=>n.printer.margins.colon,display:"inline-block"}:{}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),ln=t=>i(A,h(c({component:p},t),{sx:[e=>({fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit",lineSpacing:"inherit",fontWeight:"inherit",marginTop:e.printer.margins.paragraph}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),dn=t=>i(A,h(c({component:t.inline?"span":p},t),{inline:void 0,leftmargin:void 0,sx:[e=>c(c({},e.printer.typography.structure),t.inline?h(c({},t.leftmargin?{marginLeft:n=>n.printer.margins.colon}:{marginRight:n=>n.printer.margins.colon}),{display:"inline-block"}):{}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),cn=t=>i(p,h(c({},t),{subtitle_like:void 0,small_margin:void 0,sx:[e=>h(c({},t.subtitle_like?e.printer.typography.title:{}),{marginTop:t.small_margin?e.printer.margins.paragraph:e.printer.margins.special}),...Array.isArray(t.sx)?t.sx:[t.sx]]})),un=t=>i(p,h(c({},t),{sx:[{marginLeft:e=>e.printer.margins.level},...Array.isArray(t.sx)?t.sx:[t.sx]]})),hn=t=>i(p,h(c({},t),{sx:[{width:e=>e.printer.margins.level},...Array.isArray(t.sx)?t.sx:[t.sx]]})),Rt=t=>i(p,h(c({},t),{sx:[e=>h(c({},e.printer.typography.body),{padding:e.printer.margins.structure,boxSizing:"border-box",height:"100%",width:"100%",overflowY:"auto",wordWrap:"break-word"}),...Array.isArray(t.sx)?t.sx:[t.sx]]}));class mn extends m.Component{constructor(e){super(e);d(this,"printer");d(this,"main");this.printer=e.printer,this.main=m.createRef()}scroll_to(e){this.main.current!=null&&this.main.current.scroll_to(e)}render(){let e=Y(ge,this.props.theme),n=this.main;return i(oe,{theme:ae(e),children:i(Rt,{children:i(pe.Component,{ref:n,printer:this.printer})})})}}function Ut(){let t=se("#_data_csrf").html();return console.log("csrf",t),t}var Ht="/";B.defaults.baseURL=Ht;B.defaults.xsrfHeaderName="X-CSRFToken";B.defaults.headers.post["X-CSRFToken"]=Ut();function ye(){return parseInt(se("#_data_nodeid").html())}var C={get:{content:t=>`get_node_content/${t}`,nodetree:t=>`get_nodetree/${t}`,concept:t=>`get_node_concepts/${t}`,create_time:t=>`get_node_create_time/${t}`,comments:t=>`get_node_comments/${t}`},post:{content:t=>`post_node_content/${t}`,comments:t=>`post_node_comments/${t}`,nodetree:t=>`post_nodetree/${t}`}};async function T(t,e,n){n==null&&(n=ye());let r=(await B.get(t(n))).data;return e!=null&&(r=r[e]),r}async function Q(t,e,n){return n==null&&(n=ye()),(await B.post(t(n),e)).data.status}var fn={get:{content:t=>T(C.get.content,"content",t),nodetree:t=>T(C.get.nodetree,"data",t),concept:t=>T(C.get.concept,"concepts",t),create_time:t=>T(C.get.create_time,void 0,t),comments:t=>T(C.get.comments,"comments",t)},post:{content:(t,e)=>Q(C.post.content,t,e),nodetree:(t,e)=>Q(C.post.nodetree,t,e),comments:(t,e)=>Q(C.post.comments,t,e)}};const xe=S.exports.createContext(!1);function ve(t){let n=t.no_button||!1?p:U,r=h(c({},t),{close_item:void 0,open_item:void 0,no_button:void 0});return i(xe.Consumer,{children:o=>i(n,h(c({},r),{children:o?t.open_item:t.close_item}))})}class pn extends S.exports.Component{constructor(e){super(e);this.state={open:!1}}render(){let e=this;return i(p,{sx:c({},e.props.sx),children:i(xe.Provider,{value:e.state.open,children:_(q,{force_direction:"column",children:[i(ve,{close_item:i(w,{title:"\u5C55\u5F00",children:i(F,{size:"small",children:i(Ze,{fontSize:"small",color:"primary"})})}),open_item:i(U,{startIcon:i(et,{}),color:"primary",children:"\u6536\u655B"}),onClick:()=>{e.setState({open:!e.state.open})},no_button:!0}),e.props.children]})})})}}function Mt(t){return i(tt,{anchorOrigin:{vertical:"top",horizontal:"center"},open:t.open,message:t.status?t.info_sucess:t.info_fail,onClose:()=>t.onClose()})}function _n(t){let[e,n]=m.useState(!1),[r,o]=m.useState(!1);return _(m.Fragment,{children:[i(ve,{close_item:i(w,{title:"\u4FDD\u5B58",children:i(F,{size:"small",children:i(le,{fontSize:"small",color:"primary"})})}),open_item:i(U,{startIcon:i(le,{}),color:"primary",children:"\u4FDD\u5B58"}),onClick:()=>{t.save_func().then(a=>{o(a),n(!0)})},no_button:!0}),i(Mt,{info_sucess:"\u4FDD\u5B58\u6210\u529F",info_fail:"\u4FDD\u5B58\u5931\u8D25",open:e,status:r,onClose:()=>n(!1)})]})}export{q as A,sn as B,hn as C,Ot as D,gt as E,pn as F,P as G,me as H,fn as I,Gt as J,Xt as K,Yt as L,jt as M,rn as N,Jt as O,pe as P,qt as Q,ye as R,_n as S,Mt as T,j as Y,mn as a,Kt as b,Pt as c,Tt as d,At as e,on as f,nn as g,Bt as h,Lt as i,Qt as j,zt as k,en as l,tn as m,b as n,w as o,xt as p,vt as q,D as r,Zt as s,N as t,cn as u,Vt as v,ln as w,dn as x,un as y,an as z};
