var D=Object.defineProperty,R=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var y=(i,e,r)=>e in i?D(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,f=(i,e)=>{for(var r in e||(e={}))M.call(e,r)&&y(i,r,e[r]);if(v)for(var r of v(e))P.call(e,r)&&y(i,r,e[r]);return i},g=(i,e)=>R(i,j(e));var _=(i,e,r)=>(y(i,typeof e!="symbol"?e+"":e,r),r);import"./modulepreload-polyfill.9d8db203.js";import{a as o,j as t,B as l,b as c,I as L,i as F,a3 as C,a7 as N,a8 as U,G as S,a9 as B,v as h,c as A,e as X,aa as Y,ab as G,ac as E,ad as T,N as J,g as O,h as V,R as $}from"./vendor.7943a1a9.js";import{U as k,I as u,A as I,c as q,V as x,P as H,i as w,E as K,d as Q,z as Z,e as ee}from"./snackbar.44a006f1.js";import{n as te,w as re,b as ne,m as ie,M as oe,c as z}from"./theme.6021bc18.js";import{T as b}from"./titleword.b8976b2c.js";class se extends o.Component{constructor(e){super(e);this.state={father_id:k.node_id,son_ids:[]}}async set_father_id(e){let r=await u.get.son_ids(e);this.setState({father_id:e,son_ids:r})}async componentDidMount(){this.set_father_id(k.node_id)}WordsWithButton(e){let r=e.icon;return t(l,{sx:{marginTop:"0.5rem"},children:c(I,{children:[r?t(q,{title:e.title,children:t(L,{size:"small",sx:{height:"0.9rem",marginY:"auto"},onClick:e.onClick,children:t(r,{sx:{fontSize:"0.9rem"}})})}):t(F,{}),t(C,{sx:n=>({fontSize:"0.9rem"}),underline:"hover",href:e.url,children:e.words})]})})}SubnodeItem(e){let r=this,n=e.node_id,[s,a]=o.useState(!0),d=this.WordsWithButton.bind(this);return o.useEffect(()=>{(async()=>{let m=await u.get.son_ids(n);a(m.length>0)})()}),t(o.Fragment,{children:s?t(d,{words:t(b,{node_id:n}),title:"\u4E0B\u884C",onClick:()=>r.set_father_id(n),icon:N,url:x.view.content(n)}):t(d,{words:t(b,{node_id:n}),url:x.view.content(n)})})}FathernodeItem(e){let r=this,n=e.node_id,s=this.WordsWithButton.bind(this),[a,d]=o.useState(-1);return o.useEffect(()=>{(async()=>{d(await u.get.father_id(n))})()}),t(o.Fragment,{children:a>0?t(s,{words:t(b,{node_id:n}),title:"\u4E0A\u884C",onClick:()=>r.set_father_id(a),icon:U,url:x.view.content(n)}):t(s,{words:t(b,{node_id:n}),url:x.view.content(n)})})}render(){let e=this.state.father_id,r=this.state.son_ids,n=this.FathernodeItem.bind(this),s=this.SubnodeItem.bind(this);return t(l,{sx:{marginTop:"0.5rem"},children:c(I,{force_direction:"column",children:[t(n,{node_id:e}),t(l,{sx:{marginLeft:a=>a.printer.margins.level},children:r.map((a,d)=>t(o.Fragment,{children:t(s,{node_id:a})},d))})]})})}}class ae extends o.Component{constructor(e){super(e);this.state={create_time:void 0,modify_time:void 0}}async componentDidMount(){let e=await u.get.create_time();this.setState({create_time:e.create_time,modify_time:e.modify_time})}render(){let e=this,r=this.props.core.root.parameters.title,n=s=>c(l,{sx:a=>({marginBottom:"1rem"}),children:[t(h,{color:"text.secondary",sx:{marginRight:a=>a.printer.margins.colon,fontSize:"0.5rem",display:"inline-block"},children:s.title}),t(h,{sx:{fontSize:"0.8rem",display:"inline-block"},children:s.content})]});return c(o.Fragment,{children:[t(n,{title:"\u9898\u76EE",content:`${r}`}),t(n,{title:"\u521B\u5EFA\u65F6\u95F4",content:e.state.create_time}),t(n,{title:"\u4FEE\u6539\u65F6\u95F4",content:e.state.modify_time})]})}}class le extends o.Component{constructor(e){super(e)}render(){return c(l,{sx:e=>f({},e.printer.typography.body),children:[t(ae,{core:this.props.core}),t(S,{sx:{fontSize:"0.8rem"},children:t(B,{sx:{fontSize:"0.8rem"},label:"\u5BFC\u822A"})}),t(se,{})]})}}class ce extends o.Component{constructor(e){super(e);this.state={comments:[]}}async update(){let e=await u.get.comments();e=e.reverse(),this.setState({comments:e})}async componentDidMount(){await this.update()}render(){let e=this,r=n=>c(l,{sx:{marginBottom:"1rem",marginX:"0.5rem"},children:[t(h,{sx:{marginLeft:"0.5rem",fontSize:"0.9rem"},children:n.content}),c(h,{sx:{textAlign:"right",marginTop:"0.5rem",fontSize:"0.9rem"},children:["\u2014\u2014",n.name]})]});return t(o.Fragment,{children:e.state.comments.map((n,s)=>{let[a,d]=n;return t(r,{name:d,content:a},s)})})}}class de extends o.Component{constructor(e){super(e);this.state={content:"",name:"",snakerbar_open:!1,status:!1}}async submit(){let e=this,r=!1;e.state.content&&(r=await u.post.comments({content:e.state.content,name:e.state.name})),e.setState({status:r,snakerbar_open:!0}),r&&(e.props.onRenew(),e.setState({content:"",name:""}))}render(){let e=this;return c(o.Fragment,{children:[t(A,{label:"\u7559\u8A00",placeholder:"\u8BF4\u70B9\u5565",multiline:!0,onChange:r=>{e.setState({content:r.target.value})},variant:"outlined",fullWidth:!0,minRows:4,sx:{marginTop:"2rem"},value:e.state.content}),t(A,{label:"\u79F0\u547C",placeholder:"\u4F60\u662F\u8C01\uFF1F",onChange:r=>{e.setState({name:r.target.value})},variant:"standard",fullWidth:!0,sx:{marginTop:"0.5rem"},value:e.state.name}),t(l,{sx:{textAlign:"right",marginTop:"1rem"},children:t(X,{variant:"outlined",onClick:()=>e.submit(),children:"\u65B0\u5EFA\u7559\u8A00"})}),t(H,{info_sucess:"\u63D0\u4EA4\u6210\u529F",info_fail:"\u63D0\u4EA4\u5931\u8D25",open:e.state.snakerbar_open,status:e.state.status,onClose:()=>e.setState({snakerbar_open:!1})})]})}}class ue extends o.Component{constructor(e){super(e);_(this,"comment_ref");this.comment_ref=o.createRef()}render(){let e=this;return c(l,{sx:r=>g(f({},r.printer.typography.structure),{overflowY:"auto",position:"absolute",top:"5%",bottom:"2%",left:"0",right:"0",paddingX:"1rem"}),children:[t(de,{onRenew:()=>{e.comment_ref&&e.comment_ref.current&&e.comment_ref.current.update()}}),t(S,{sx:{marginTop:"3rem"},children:t(B,{sx:{fontSize:"0.8rem"},label:"\u7559\u8A00\u5217\u8868"})}),t(ce,{ref:e.comment_ref})]})}}function me(i){const[e,r]=o.useState("1");return t(Y,{value:e,children:c(l,{sx:{height:"100%"},children:[c(G,{onChange:(n,s)=>r(s),variant:"scrollable",scrollButtons:"auto",children:[t(E,{label:"\u57FA\u672C",value:"1"}),t(E,{label:"\u7559\u8A00",value:"2"})]}),t(T,{value:"1",children:t(le,{core:i.core})}),t(T,{value:"2",children:t(ue,{})})]})})}function he(i){let e=[];for(let[r,n]of J.descendants(i))(w(r,"support","\u5C0F\u8282\u7EBF")||w(r,"support","\u7AE0\u8282\u7EBF"))&&e.push([r,n]);return e}function pe(i){let e=i.core.root,r=he(e);return c(l,{sx:n=>g(f({},n.printer.typography.body),{position:"relative",top:"30%"}),children:[t(h,{color:"text.secondary",sx:n=>g(f({},n.printer.typography.body),{fontSize:"0.9rem"}),children:"\u7AE0\u5185\u76EE\u5F55"}),r.map((n,s)=>{let[a,d]=n,m=t(F,{children:"\u7AE0\u8282"});return w(a,"support","\u5C0F\u8282\u7EBF")&&(m=c(o.Fragment,{children:[t(l,{component:"span",sx:{marginRight:"1rem"},children:te(Number(s)+1)}),t(l,{component:"span",children:a.parameters.title})]})),t(l,{sx:{marginTop:"0.2rem"},children:t(C,{component:"button",underline:"hover",onClick:p=>{i.onScroll(d)},children:t(h,{sx:{fontSize:"0.8rem"},children:m})})},s)})]})}class fe extends o.Component{constructor(e){super(e);_(this,"core");_(this,"printer");_(this,"printer_ref");this.core=re(new K([],{title:""})),this.printer=ne(new Q(this.core)),this.printer_ref=o.createRef()}async componentDidMount(){var e=await u.get.content();this.core.update_root(e);var r=await u.get.concept();for(let[n,s,a,d,m]of r){let[p,_e,W]=ie(s,n,a,d,m);this.core.add_style(p),p.type!="abstract"&&this.printer.update_renderer(W,p.type,p.name)}this.forceUpdate()}render(){let e=this;return t(oe,{children:c(O,{theme:V(z),children:[t(l,{sx:{position:"absolute",top:"2%",left:"1%",height:"96%",width:"17%"},children:t(me,{core:e.printer.core})}),c(l,{sx:{position:"absolute",top:"2%",left:"20%",height:"96%",width:"60%",display:"flex"},children:[t(l,{sx:{position:"absolute",width:"98%",left:"1%",top:"1%",height:"3%"},children:t(Z,{sx:{textAlign:"center"},children:e.printer.core.root.parameters.title})}),t(l,{sx:{position:"absolute",width:"98%",left:"1%",top:"5%",height:"94%"},children:t(ee,{printer:e.printer,theme:z,ref:e.printer_ref})})]}),t(l,{sx:{position:"absolute",top:"2%",left:"81%",height:"96%",width:"17%"},children:t(pe,{core:e.printer.core,onScroll:r=>{e.printer_ref&&e.printer_ref.current&&e.printer_ref.current.scroll_to(r)}})})]})})}}$.render(t(o.StrictMode,{children:t(fe,{})}),document.getElementById("root"));
