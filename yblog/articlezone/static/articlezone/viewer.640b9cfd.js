var R=Object.defineProperty,I=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var b=(n,e,r)=>e in n?R(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,p=(n,e)=>{for(var r in e||(e={}))N.call(e,r)&&b(n,r,e[r]);if(C)for(var r of C(e))j.call(e,r)&&b(n,r,e[r]);return n},x=(n,e)=>I(n,M(e));var f=(n,e,r)=>(b(n,typeof e!="symbol"?e+"":e,r),r);import"./modulepreload-polyfill.9d8db203.js";import{a as s,j as t,i as g,B as a,b as c,a7 as P,a8 as L,G as S,a9 as F,I as W,a3 as B,v as u,c as A,e as U,aa as X,ab as Y,ac as E,ad as T,N as G,g as J,h as O,R as V}from"./vendor.96b1bcce.js";import{I as m,U as $,A as k,V as y,c as q,P as H,i as v,E as K,d as Q,z as Z,e as ee}from"./snackbar.978d4283.js";import{n as te,w as re,b as ne,m as oe,M as ie,c as z}from"./theme.510b2d56.js";import{N as ae}from"./nodetree.fc3a4e5d.js";class w extends s.Component{constructor(e){super(e);this.state={title:void 0}}async componentDidMount(){let e=await m.get.content(this.props.node_id);this.setState({title:e.parameters.title})}render(){return t(g,{children:this.state.title})}}class se extends s.Component{constructor(e){super(e);this.state={nodetree:void 0,now_node_id:void 0}}async componentDidMount(){let e=await m.get.nodetree(0);this.setState({nodetree:new ae(e),now_node_id:$.node_id})}render(){if(this.state.now_node_id==null)return t(g,{});let e=this,r=this.state.nodetree.id2node(this.state.now_node_id),o=i=>{let l=i.icon;return t(a,{sx:{marginTop:"0.5rem"},children:c(k,{children:[l?t(q,{title:i.title,children:t(W,{size:"small",sx:{height:"0.9rem",marginY:"auto"},onClick:i.onClick,children:t(l,{sx:{fontSize:"0.9rem"}})})}):t(g,{}),t(B,{sx:d=>({fontSize:"0.9rem"}),underline:"hover",href:i.url,children:i.words})]})})};return t(a,{sx:{marginTop:"0.5rem"},children:c(k,{force_direction:"column",children:[r.father_id>=0?t(o,{words:t(w,{node_id:r.my_id}),title:"\u4E0A\u884C",onClick:()=>e.setState({now_node_id:r.father_id}),icon:P,url:y.view.content(r.my_id)}):t(o,{words:t(w,{node_id:r.my_id}),url:y.view.content(r.my_id)}),r.sons.map((i,l)=>t(a,{sx:{marginLeft:d=>d.printer.margins.level},children:i.sons.length>0?t(o,{words:t(w,{node_id:i.my_id}),title:"\u4E0B\u884C",onClick:()=>e.setState({now_node_id:i.my_id}),icon:L,url:y.view.content(i.my_id)}):t(o,{words:t(w,{node_id:i.my_id}),url:y.view.content(i.my_id)})},l))]})})}}class ce extends s.Component{constructor(e){super(e);this.state={create_time:void 0,modify_time:void 0}}async componentDidMount(){let e=await m.get.create_time();this.setState({create_time:e.create_time,modify_time:e.modify_time})}render(){let e=this,r=this.props.core.root.parameters.title,o=i=>c(a,{sx:l=>({marginBottom:"1rem"}),children:[t(u,{color:"text.secondary",sx:{marginRight:l=>l.printer.margins.colon,fontSize:"0.5rem",display:"inline-block"},children:i.title}),t(u,{sx:{fontSize:"0.8rem",display:"inline-block"},children:i.content})]});return c(s.Fragment,{children:[t(o,{title:"\u9898\u76EE",content:`${r}`}),t(o,{title:"\u521B\u5EFA\u65F6\u95F4",content:e.state.create_time}),t(o,{title:"\u4FEE\u6539\u65F6\u95F4",content:e.state.modify_time})]})}}class le extends s.Component{constructor(e){super(e)}render(){return c(a,{sx:e=>p({},e.printer.typography.body),children:[t(ce,{core:this.props.core}),t(S,{sx:{fontSize:"0.8rem"},children:t(F,{sx:{fontSize:"0.8rem"},label:"\u5BFC\u822A"})}),t(se,{})]})}}class de extends s.Component{constructor(e){super(e);this.state={comments:[]}}async update(){let e=await m.get.comments();e=e.reverse(),this.setState({comments:e})}async componentDidMount(){await this.update()}render(){let e=this,r=o=>c(a,{sx:{marginBottom:"1rem",marginX:"0.5rem"},children:[t(u,{sx:{marginLeft:"0.5rem",fontSize:"0.9rem"},children:o.content}),c(u,{sx:{textAlign:"right",marginTop:"0.5rem",fontSize:"0.9rem"},children:["\u2014\u2014",o.name]})]});return t(s.Fragment,{children:e.state.comments.map((o,i)=>{let[l,d]=o;return t(r,{name:d,content:l},i)})})}}class me extends s.Component{constructor(e){super(e);this.state={content:"",name:"",snakerbar_open:!1,status:!1}}async submit(){let e=this,r=!1;e.state.content&&(r=await m.post.comments({content:e.state.content,name:e.state.name})),e.setState({status:r,snakerbar_open:!0}),r&&(e.props.onRenew(),e.setState({content:"",name:""}))}render(){let e=this;return c(s.Fragment,{children:[t(A,{label:"\u7559\u8A00",placeholder:"\u8BF4\u70B9\u5565",multiline:!0,onChange:r=>{e.setState({content:r.target.value})},variant:"outlined",fullWidth:!0,minRows:4,sx:{marginTop:"2rem"},value:e.state.content}),t(A,{label:"\u79F0\u547C",placeholder:"\u4F60\u662F\u8C01\uFF1F",onChange:r=>{e.setState({name:r.target.value})},variant:"standard",fullWidth:!0,sx:{marginTop:"0.5rem"},value:e.state.name}),t(a,{sx:{textAlign:"right",marginTop:"1rem"},children:t(U,{variant:"outlined",onClick:()=>e.submit(),children:"\u65B0\u5EFA\u7559\u8A00"})}),t(H,{info_sucess:"\u63D0\u4EA4\u6210\u529F",info_fail:"\u63D0\u4EA4\u5931\u8D25",open:e.state.snakerbar_open,status:e.state.status,onClose:()=>e.setState({snakerbar_open:!1})})]})}}class ue extends s.Component{constructor(e){super(e);f(this,"comment_ref");this.comment_ref=s.createRef()}render(){let e=this;return c(a,{sx:r=>x(p({},r.printer.typography.structure),{overflowY:"auto",position:"absolute",top:"5%",bottom:"2%",left:"0",right:"0",paddingX:"1rem"}),children:[t(me,{onRenew:()=>{e.comment_ref&&e.comment_ref.current&&e.comment_ref.current.update()}}),t(S,{sx:{marginTop:"3rem"},children:t(F,{sx:{fontSize:"0.8rem"},label:"\u7559\u8A00\u5217\u8868"})}),t(de,{ref:e.comment_ref})]})}}function he(n){const[e,r]=s.useState("1");return t(X,{value:e,children:c(a,{sx:{height:"100%"},children:[c(Y,{onChange:(o,i)=>r(i),variant:"scrollable",scrollButtons:"auto",children:[t(E,{label:"\u57FA\u672C",value:"1"}),t(E,{label:"\u7559\u8A00",value:"2"})]}),t(T,{value:"1",children:t(le,{core:n.core})}),t(T,{value:"2",children:t(ue,{})})]})})}function pe(n){let e=[];for(let[r,o]of G.descendants(n))(v(r,"support","\u5C0F\u8282\u7EBF")||v(r,"support","\u7AE0\u8282\u7EBF"))&&e.push([r,o]);return e}function fe(n){let e=n.core.root,r=pe(e);return c(a,{sx:o=>x(p({},o.printer.typography.body),{position:"relative",top:"30%"}),children:[t(u,{color:"text.secondary",sx:o=>x(p({},o.printer.typography.body),{fontSize:"0.9rem"}),children:"\u7AE0\u5185\u76EE\u5F55"}),r.map((o,i)=>{let[l,d]=o,_=t(g,{children:"\u7AE0\u8282"});return v(l,"support","\u5C0F\u8282\u7EBF")&&(_=c(s.Fragment,{children:[t(a,{component:"span",sx:{marginRight:"1rem"},children:te(Number(i)+1)}),t(a,{component:"span",children:l.parameters.title})]})),t(a,{sx:{marginTop:"0.2rem"},children:t(B,{component:"button",underline:"hover",onClick:h=>{n.onScroll(d)},children:t(u,{sx:{fontSize:"0.8rem"},children:_})})},i)})]})}class _e extends s.Component{constructor(e){super(e);f(this,"core");f(this,"printer");f(this,"printer_ref");this.core=re(new K([],{title:""})),this.printer=ne(new Q(this.core)),this.printer_ref=s.createRef()}async componentDidMount(){var e=await m.get.content();this.core.update_root(e);var r=await m.get.concept();for(let[o,i,l,d,_]of r){let[h,xe,D]=oe(i,o,l,d,_);this.core.add_style(h),h.type!="abstract"&&this.printer.update_renderer(D,h.type,h.name)}this.forceUpdate()}render(){let e=this;return t(ie,{children:c(J,{theme:O(z),children:[t(a,{sx:{position:"absolute",top:"2%",left:"1%",height:"96%",width:"17%"},children:t(he,{core:e.printer.core})}),c(a,{sx:{position:"absolute",top:"2%",left:"20%",height:"96%",width:"60%",display:"flex"},children:[t(a,{sx:{position:"absolute",width:"98%",left:"1%",top:"1%",height:"3%"},children:t(Z,{sx:{textAlign:"center"},children:e.printer.core.root.parameters.title})}),t(a,{sx:{position:"absolute",width:"98%",left:"1%",top:"5%",height:"94%"},children:t(ee,{printer:e.printer,theme:z,ref:e.printer_ref})})]}),t(a,{sx:{position:"absolute",top:"2%",left:"81%",height:"96%",width:"17%"},children:t(fe,{core:e.printer.core,onScroll:r=>{e.printer_ref&&e.printer_ref.current&&e.printer_ref.current.scroll_to(r)}})})]})})}}V.render(t(s.StrictMode,{children:t(_e,{})}),document.getElementById("root"));
